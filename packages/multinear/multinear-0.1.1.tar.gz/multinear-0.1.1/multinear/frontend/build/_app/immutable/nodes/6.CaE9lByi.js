import{d as st,a as r,s as Ee,f as Ne,t as l,e as _,b as n,c as Oe}from"../chunks/disclose-version.DJKRdGjo.js";import{i as Re}from"../chunks/legacy.RfLVu9Ez.js";import{f as h,p as Ae,l as se,b as ke,t as v,a as Me,$ as Je,g as t,d as N,c as s,r as a,s as e,n as b,m as Z,e as ze,i as It}from"../chunks/index-client.CTjIiTiR.js";import{l as qe,s as Be,i as y}from"../chunks/props.hsVcazBB.js";import{d as He,e as St,i as Dt,h as Ke,j as Ve}from"../chunks/projects.Dr8v4MvC.js";import{s as zt}from"../chunks/class.C1IRLL_p.js";import{C as oe,a as _e,b as Ge,c as $e}from"../chunks/card-title.CQjx23s_.js";import{L as Qe,I as Ue,C as We,T as fe,a as pe,b as Ct,c as q,d as me,e as ge,f as R,g as de,i as le}from"../chunks/TimeAgo.BCtM0NRR.js";import{C as Xe}from"../chunks/card-footer.CRrXLl0S.js";import{B as ie}from"../chunks/index.-62bZizV.js";import{I as Ye,a as Ze}from"../chunks/index.CXFO8A2a.js";import{S as tr,f as er,g as rr,t as ar,a as sr}from"../chunks/tasks.BJm414gF.js";import{g as or}from"../chunks/entry.CGI9eiKr.js";function dr(qt,jt){const Bt=qe(jt,["children","$$slots","$$events","$$legacy"]);Ye(qt,Be({name:"chevron-right"},()=>Bt,{iconNode:[["path",{d:"m9 18 6-6-6-6"}]],children:(j,Ht)=>{var Ft=st(),m=h(Ft);He(m,jt,"default",{},null),r(j,Ft)},$$slots:{default:!0}}))}var lr=l('<span class="text-xl text-gray-500"><!></span>'),ir=l('<div class="flex gap-2 items-center"><span class="text-sm text-gray-500">Project</span> <span class="text-md text-gray-800"> </span></div>'),nr=l('<div class="text-center text-gray-500">Loading run details...</div>'),vr=l("<!> <!>",1),cr=l("<!> <!>",1),ur=l('<div class="grid grid-cols-2 md:grid-cols-4 gap-4"><div class="space-y-1"><div class="text-sm text-gray-500">Status</div> <div class="font-semibold"> </div></div> <div class="space-y-1"><div class="text-sm text-gray-500">Total Tasks</div> <div class="font-semibold"> </div></div> <div class="space-y-1"><div class="text-sm text-gray-500">Model</div> <div class="font-semibold"> </div></div> <div class="space-y-1"><!> <!></div></div> <div class="flex gap-8 items-end mt-4"><!></div>',1),_r=l("<!> <!> <!> <!> <!> <!> <!> <!>",1),$r=l("<span> </span>"),fr=l('<div class="w-full bg-gray-200 rounded-sm h-4 dark:bg-gray-700 overflow-hidden flex"><div></div></div> <div class="text-center text-xs font-medium"> </div>',1),pr=l("<!> <!> <!> <!> <!> <!> <!> <!>",1),mr=l('<div><h5 class="font-semibold mb-1">Input</h5> <div class="text-sm bg-white p-2 rounded border overflow-auto" style="white-space: pre-wrap;"> </div></div>'),gr=l('<div><div class="flex justify-between items-center mb-1"><h5 class="font-semibold">Output</h5> <!></div> <div class="text-sm bg-white p-2 rounded border overflow-auto" style="white-space: pre-wrap;"> </div></div>'),xr=l('<div class="mb-1 pl-2"><h6 class="font-semibold"> </h6> <div class="text-sm bg-white p-2 rounded border overflow-auto" style="white-space: pre-wrap;"> </div></div>'),hr=l('<div><h5 class="font-semibold mb-1">Details</h5> <!></div>'),br=l("<tr><td> </td><td> </td><td> </td></tr>"),yr=l('<div><h5 class="font-semibold mb-1">Logs</h5> <details><summary class="cursor-pointer text-blue-500">Show Logs</summary> <table class="text-sm bg-white p-2 rounded border overflow-auto w-full mt-2"><thead><tr><th class="text-left">Level</th><th class="text-left">Timestamp</th><th class="text-left">Message</th></tr></thead><tbody></tbody></table></details></div>'),wr=l("<!> <!>",1),Pr=l('<div class="space-y-1"><div> </div> <div class="text-sm text-gray-500"> </div></div>'),Tr=l("<div> </div>"),Ir=l("<!> <!>",1),Sr=l("<!> <!>",1),Dr=l("<div><!></div>"),Cr=l('<div class="mb-1 pl-2"><h6 class="font-semibold"> </h6> <div class="text-sm bg-white p-2 rounded border overflow-auto" style="white-space: pre-wrap;"> </div></div>'),jr=l('<div><h5 class="font-semibold mb-1">Details</h5> <!></div>'),Fr=l('<div class="p-4 grid grid-cols-1 md:grid-cols-2 gap-6"><div class="space-y-4 pr-12 border-r border-gray-200"><div class="flex justify-between items-center mb-2"><h4 class="font-semibold text-lg">Task</h4> <div class="text-sm text-gray-800">Duration: <!></div></div> <!> <!> <!> <!></div> <div class="space-y-4 pl-4"><div class="flex justify-between items-center mb-2"><h4 class="font-semibold text-lg">Evaluation</h4> <div class="flex items-center gap-4"><div class="text-sm text-gray-800">Duration: <!></div> <div class="text-sm text-gray-800"> </div> <div> </div></div></div> <!> <!></div></div>'),Lr=l("<!> <!>",1),Er=l("<!> <!>",1),Nr=l('<div class="space-y-6"><!> <!></div>'),Or=l('<div class="text-center text-gray-500">No run found</div>'),Rr=l('<div class="container mx-auto p-4"><div class="flex justify-between items-center mb-4"><div class="flex gap-12 items-center"><h1 class="text-3xl font-bold"> </h1> <!></div> <!></div> <!></div>');function Wr(qt,jt){Ae(jt,!1);const Bt=Ee(),pt=()=>Oe(Ve,"$selectedRunId",Bt),j=Z(),Ht=Z();let Ft=null,m=Z(null),Kt=Z(!0),Lt=Z(null),A=Z(null);async function ne(i){N(Kt,!0),N(Lt,null);try{N(m,await Ze(i))}catch(f){N(Lt,f instanceof Error?f.message:"Failed to load run details"),console.error(f)}finally{N(Kt,!1)}}let Et=Z(""),Nt=Z("");async function Vt(){if(!t(A))return;await ze();const i=document.querySelector(`[data-task-id="${t(A)}"]`);i&&i.scrollIntoView({behavior:"smooth",block:"start"})}async function xe(){if(!t(j).length)return;const i=t(A)?t(j).findIndex(k=>k.id===t(A)):-1,f=i<t(j).length-1?i+1:0;N(A,t(j)[f].id),await Vt()}async function he(){if(!t(j).length)return;const i=t(A)?t(j).findIndex(k=>k.id===t(A)):0,f=i>0?i-1:t(j).length-1;N(A,t(j)[f].id),await Vt()}function be(i){i.target instanceof HTMLInputElement||i.target instanceof HTMLTextAreaElement||(i.key==="j"?xe():i.key==="k"&&he())}se(()=>pt(),()=>{pt()&&ne(pt())}),se(()=>(t(m),t(Et),t(Nt)),()=>{var i;N(j,er(((i=t(m))==null?void 0:i.tasks)||[],t(Et),t(Nt)))}),se(()=>t(m),()=>{var i;N(Ht,rr(((i=t(m))==null?void 0:i.tasks)||[]))}),ke(),Re();var Gt=Rr();Ne("keydown",Je,be);var Qt=s(Gt),Ut=s(Qt),Wt=s(Ut),ye=s(Wt);v(()=>n(ye,`Run: ${pt().slice(-8)??""}`)),a(Wt);var we=e(Wt,2);y(we,()=>t(m),i=>{var f=lr(),k=s(f);ge(k,{get date(){return t(m).date}}),a(f),r(i,f)}),a(Ut);var Pe=e(Ut,2);y(Pe,()=>t(m),i=>{var f=ir(),k=e(s(f),2),mt=s(k,!0);a(k),a(f),v(()=>n(mt,t(m).project.name)),r(i,f)}),a(Qt);var Te=e(Qt,2);y(Te,()=>t(Kt),i=>{var f=nr();r(i,f)},i=>{var f=st(),k=h(f);y(k,()=>t(Lt),mt=>{oe(mt,{class:"border-red-200 bg-red-50",children:(Ot,ve)=>{var ot=cr(),G=h(ot);_e(G,{children:(gt,xt)=>{var dt=vr(),tt=h(dt);Ge(tt,{class:"text-red-800",children:(et,Xt)=>{b();var M=_("Error");r(et,M)},$$slots:{default:!0}});var ht=e(tt,2);$e(ht,{class:"text-red-600",children:(et,Xt)=>{b();var M=_();v(()=>n(M,t(Lt))),r(et,M)},$$slots:{default:!0}}),r(gt,dt)},$$slots:{default:!0}});var Rt=e(G,2);Xe(Rt,{class:"flex justify-end",children:(gt,xt)=>{ie(gt,{variant:"outline",class:"border-red-200 text-red-800 hover:bg-red-100",$$events:{click:()=>ne(Ft)},children:(dt,tt)=>{b();var ht=_("Try Again");r(dt,ht)},$$slots:{default:!0}})},$$slots:{default:!0}}),r(Ot,ot)},$$slots:{default:!0}})},mt=>{var Ot=st(),ve=h(Ot);y(ve,()=>t(m),ot=>{var G=Nr(),Rt=s(G);oe(Rt,{class:"pb-4",children:(xt,dt)=>{_e(xt,{children:(tt,ht)=>{$e(tt,{children:(et,Xt)=>{var M=ur(),lt=h(M),bt=s(lt),it=e(s(bt),2),Yt=s(it,!0);a(it),a(bt);var Q=e(bt,2),yt=e(s(Q),2),nt=s(yt,!0);a(yt),a(Q);var o=e(Q,2),U=e(s(o),2),B=s(U,!0);a(U),a(o);var W=e(o,2),X=s(W);Qe(X,{for:"search",children:(c,D)=>{b();var p=_("Search");r(c,p)},$$slots:{default:!0}});var vt=e(X,2);Ue(vt,{id:"search",placeholder:"Search tasks...",get value(){return t(Nt)},set value(c){N(Nt,c)},$$legacy:!0}),a(W),a(lt);var rt=e(lt,2),H=s(rt);y(H,()=>t(m).tasks.length>=5,c=>{tr(c,{get statusFilter(){return t(Et)},set statusFilter(D){N(Et,D)},get statusCounts(){return t(Ht)},get totalCount(){return t(m).tasks.length},$$legacy:!0})}),a(rt),v(()=>{n(Yt,t(m).status),n(nt,t(m).tasks.length),n(B,t(m).details.model||"N/A")}),r(et,M)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}});var gt=e(Rt,2);oe(gt,{children:(xt,dt)=>{We(xt,{children:(tt,ht)=>{fe(tt,{class:"-mt-4",children:(et,Xt)=>{var M=Er(),lt=h(M);pe(lt,{children:(it,Yt)=>{Ct(it,{children:(Q,yt)=>{var nt=_r(),o=h(nt);q(o,{});var U=e(o,2);q(U,{children:(c,D)=>{b();var p=_("Task ID");r(c,p)},$$slots:{default:!0}});var B=e(U,2);q(B,{children:(c,D)=>{b();var p=_("Started");r(c,p)},$$slots:{default:!0}});var W=e(B,2);q(W,{children:(c,D)=>{b();var p=_("Duration");r(c,p)},$$slots:{default:!0}});var X=e(W,2);q(X,{children:(c,D)=>{b();var p=_("Model");r(c,p)},$$slots:{default:!0}});var vt=e(X,2);q(vt,{children:(c,D)=>{b();var p=_("Input");r(c,p)},$$slots:{default:!0}});var rt=e(vt,2);q(rt,{children:(c,D)=>{b();var p=_("Status");r(c,p)},$$slots:{default:!0}});var H=e(rt,2);q(H,{children:(c,D)=>{b();var p=_("Score");r(c,p)},$$slots:{default:!0}}),r(Q,nt)},$$slots:{default:!0}})},$$slots:{default:!0}});var bt=e(lt,2);me(bt,{children:(it,Yt)=>{var Q=st(),yt=h(Q);St(yt,1,()=>t(j),Dt,(nt,o)=>{var U=Lr();const B=It(()=>t(A)===t(o).id),W=It(()=>{const{isPassed:H,statusClass:c}=sr(t(o));return{isPassed:H,statusClass:c}});var X=h(U),vt=It(()=>`cursor-pointer ${t(W).statusClass}`);Ct(X,{get"data-task-id"(){return t(o).id},get class(){return t(vt)},$$events:{click:()=>{N(A,t(B)?null:t(o).id),t(B)&&Vt()}},children:(H,c)=>{var D=pr(),p=h(D);R(p,{class:"w-4",children:(g,J)=>{ie(g,{variant:"ghost",size:"sm",class:"h-4 w-4 p-0",children:(u,S)=>{var F=It(()=>`h-4 w-4 transition-transform duration-200 text-gray-400
                                                ${(t(B)?"rotate-90":"")??""}`);dr(u,{get class(){return t(F)}})},$$slots:{default:!0}})},$$slots:{default:!0}});var Zt=e(p,2);R(Zt,{class:"font-medium font-mono",children:(g,J)=>{b();var u=_();v(()=>n(u,t(o).id.slice(-8))),r(g,u)},$$slots:{default:!0}});var ct=e(Zt,2);R(ct,{children:(g,J)=>{ge(g,{get date(){return t(o).created_at}})},$$slots:{default:!0}});var ut=e(ct,2);R(ut,{children:(g,J)=>{var u=st(),S=h(u);y(S,()=>t(o).finished_at,F=>{var K=_();v(()=>n(K,de(le({start:new Date(t(o).created_at),end:new Date(t(o).finished_at)}),{format:["minutes","seconds"]}))),r(F,K)},F=>{var K=_("-");r(F,K)}),r(g,u)},$$slots:{default:!0}});var _t=e(ut,2);R(_t,{children:(g,J)=>{b();var u=_();v(()=>{var S;return n(u,((S=t(o).task_details)==null?void 0:S.model)||"-")}),r(g,u)},$$slots:{default:!0}});var wt=e(_t,2);R(wt,{class:"max-w-xs",children:(g,J)=>{b();var u=_();v(()=>n(u,ar(t(o).task_input))),r(g,u)},$$slots:{default:!0}});var At=e(wt,2);R(At,{children:(g,J)=>{var u=$r(),S=s(u,!0);a(u),v(()=>{zt(u,`inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium
                                            ${t(o).status==="completed"?"bg-green-100 text-green-800":t(o).status==="failed"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`),n(S,t(o).status)}),r(g,u)},$$slots:{default:!0}});var kt=e(At,2);R(kt,{children:(g,J)=>{var u=fr(),S=h(u),F=s(S);const K=It(()=>`width: ${(t(o).eval_score*100).toFixed(0)??""}%`);a(S);var $t=e(S,2),te=s($t);v(()=>n(te,`${(t(o).eval_score*100).toFixed(0)??""}%`)),a($t),v(()=>{zt(F,`h-4 min-w-[5px] ${(t(W).isPassed?"bg-green-600":"bg-red-600")??""}`),Ke(F,"style",t(K))}),r(g,u)},$$slots:{default:!0}}),r(H,D)},$$slots:{default:!0}});var rt=e(X,2);y(rt,()=>t(B),H=>{Ct(H,{class:"bg-gray-50 hover:bg-gray-50",children:(c,D)=>{R(c,{colspan:8,class:"border-t border-gray-100",children:(p,Zt)=>{var ct=Fr(),ut=s(ct),_t=s(ut),wt=e(s(_t),2),At=e(s(wt));y(At,()=>t(o).executed_at,$=>{var d=_();v(()=>n(d,de(le({start:new Date(t(o).created_at),end:new Date(t(o).executed_at)}),{format:["minutes","seconds"]}))),r($,d)},$=>{var d=_("-");r($,d)}),a(wt),a(_t);var kt=e(_t,2);y(kt,()=>t(o).task_input,$=>{var d=mr(),w=e(s(d),2),L=s(w,!0);v(()=>n(L,typeof t(o).task_input=="object"&&"str"in t(o).task_input?t(o).task_input.str:JSON.stringify(t(o).task_input,null,2))),a(w),a(d),r($,d)});var g=e(kt,2);y(g,()=>t(o).task_output,$=>{var d=gr(),w=s(d),L=e(s(w),2);ie(L,{variant:"outline",size:"sm",class:"text-sm bg-gray-200 hover:bg-gray-300 dark:hover:bg-gray-700 transition-colors",$$events:{click:()=>{const x=t(m).project.id,P=t(o).challenge_id;or(`/compare#${x}/c:${P}`)}},children:(x,P)=>{b();var T=_("Cross-Compare");r(x,T)},$$slots:{default:!0}}),a(w);var E=e(w,2),O=s(E,!0);v(()=>n(O,typeof t(o).task_output=="object"&&"str"in t(o).task_output?t(o).task_output.str:JSON.stringify(t(o).task_output,null,2))),a(E),a(d),r($,d)});var J=e(g,2);y(J,()=>t(o).task_details,$=>{var d=hr(),w=e(s(d),2);St(w,1,()=>Object.entries(t(o).task_details),Dt,(L,E)=>{let O=()=>t(E)[0],x=()=>t(E)[1];var P=xr(),T=s(P),at=s(T,!0);a(T);var I=e(T,2),z=s(I,!0);v(()=>n(z,typeof x()=="string"?x():JSON.stringify(x(),null,2))),a(I),a(P),v(()=>n(at,O())),r(L,P)}),a(d),r($,d)});var u=e(J,2);y(u,()=>t(o).task_logs,$=>{var d=yr(),w=e(s(d),2),L=e(s(w),2),E=e(s(L));St(E,5,()=>t(o).task_logs.logs,Dt,(O,x)=>{var P=br(),T=s(P),at=s(T,!0);a(T);var I=e(T),z=s(I,!0);v(()=>n(z,new Date(t(x).timestamp*1e3).toLocaleString())),a(I);var V=e(I),C=s(V,!0);a(V),a(P),v(()=>{n(at,t(x).level),n(C,t(x).message)}),r(O,P)}),a(E),a(L),a(w),a(d),r($,d)}),a(ut);var S=e(ut,2),F=s(S),K=e(s(F),2),$t=s(K),te=e(s($t));y(te,()=>t(o).evaluated_at,$=>{var d=_();v(()=>n(d,de(le({start:new Date(t(o).executed_at),end:new Date(t(o).evaluated_at)}),{format:["minutes","seconds"]}))),r($,d)},$=>{var d=_("-");r($,d)}),a($t);var ee=e($t,2),Ie=s(ee);v(()=>n(Ie,`Score: ${(t(o).eval_score*100).toFixed(0)??""}%`)),a(ee);var re=e(ee,2),Se=s(re,!0);a(re),a(K),a(F);var ce=e(F,2);y(ce,()=>{var $;return($=t(o).eval_details)==null?void 0:$.evaluations},$=>{var d=Dr(),w=s(d);fe(w,{children:(L,E)=>{var O=Sr(),x=h(O);pe(x,{children:(T,at)=>{Ct(T,{children:(I,z)=>{var V=wr(),C=h(V);q(C,{children:(Mt,Jt)=>{b();var ft=_("Criteria");r(Mt,ft)},$$slots:{default:!0}});var Pt=e(C,2);q(Pt,{class:"w-24 text-center",children:(Mt,Jt)=>{b();var ft=_("Score");r(Mt,ft)},$$slots:{default:!0}}),r(I,V)},$$slots:{default:!0}})},$$slots:{default:!0}});var P=e(x,2);me(P,{children:(T,at)=>{var I=st(),z=h(I);St(z,1,()=>t(o).eval_details.evaluations,Dt,(V,C)=>{Ct(V,{children:(Pt,Mt)=>{var Jt=Ir(),ft=h(Jt);R(ft,{children:(ae,je)=>{var Y=Pr(),Tt=s(Y),Fe=s(Tt,!0);a(Tt);var ue=e(Tt,2),Le=s(ue,!0);a(ue),a(Y),v(()=>{n(Fe,t(C).criterion),n(Le,t(C).rationale)}),r(ae,Y)},$$slots:{default:!0}});var Ce=e(ft,2);R(Ce,{class:"text-center",children:(ae,je)=>{var Y=Tr(),Tt=s(Y);v(()=>n(Tt,`${(t(C).score*100).toFixed(0)??""}%`)),a(Y),v(()=>zt(Y,`inline-flex items-center justify-center w-12 h-12 rounded-full 
                                                                                    ${(t(C).score>=1?"bg-green-100 text-green-800":t(C).score>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800")??""}`)),r(ae,Y)},$$slots:{default:!0}}),r(Pt,Jt)},$$slots:{default:!0}})}),r(T,I)},$$slots:{default:!0}}),r(L,O)},$$slots:{default:!0}}),a(d),r($,d)});var De=e(ce,2);y(De,()=>t(o).eval_details,$=>{var d=jr(),w=e(s(d),2);St(w,1,()=>Object.entries(t(o).eval_details),Dt,(L,E)=>{let O=()=>t(E)[0],x=()=>t(E)[1];var P=st(),T=h(P);y(T,()=>O()!=="evaluations",at=>{var I=Cr(),z=s(I),V=s(z,!0);a(z);var C=e(z,2),Pt=s(C,!0);v(()=>n(Pt,typeof x()=="string"?x():JSON.stringify(x(),null,2))),a(C),a(I),v(()=>n(V,O())),r(at,I)}),r(L,P)}),a(d),r($,d)}),a(S),a(ct),v(()=>{zt(re,`px-4 py-1 rounded-lg font-semibold
                                                                ${t(o).eval_passed?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`),n(Se,t(o).eval_passed?"PASSED":"FAILED")}),r(p,ct)},$$slots:{default:!0}})},$$slots:{default:!0}})}),r(nt,U)}),r(it,Q)},$$slots:{default:!0}}),r(et,M)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),a(G),r(ot,G)},ot=>{var G=Or();r(ot,G)},!0),r(mt,Ot)},!0),r(i,f)}),a(Gt),r(qt,Gt),Me()}export{Wr as component};
