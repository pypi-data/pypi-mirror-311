import{d as C,a as t,s as mt,c as tt,e as M,t as s,b as z}from"../chunks/disclose-version.DJKRdGjo.js";import{i as nt}from"../chunks/legacy.RfLVu9Ez.js";import{f as a,p as dt,a as it,c as l,s as n,t as D,r,n as N,g as m,i as Ot,l as jt,b as Tt,d as Z,m as st}from"../chunks/index-client.CTjIiTiR.js";import{l as gt,s as bt,i as x,p as St}from"../chunks/props.hsVcazBB.js";import{C as lt,a as ut,b as _t,c as wt}from"../chunks/card-title.CPHy0yxs.js";import{C as Dt}from"../chunks/TimeAgo.ByEiI2Wn.js";import{C as kt}from"../chunks/card-footer.CF9WstWs.js";import{B as $t}from"../chunks/index.btGWqnpN.js";import{I as ht,s as qt,c as zt,g as Bt}from"../chunks/index.D-v0UAeq.js";import{d as xt,e as pt,i as ft,h as ot,c as Ct,p as Ft,a as Kt,b as Ut}from"../chunks/projects.B4n7Uloc.js";import{A as Rt,C as Et,a as At,b as Lt,L as Jt,R as Gt}from"../chunks/RunsWithFilters.9aILdRxH.js";import{s as Pt}from"../chunks/class.C1IRLL_p.js";import{w as Mt}from"../chunks/entry.CTB_l6bl.js";function Vt(y,p){const u=gt(p,["children","$$slots","$$events","$$legacy"]);ht(y,bt({name:"circle-check"},()=>u,{iconNode:[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"m9 12 2 2 4-4"}]],children:(d,g)=>{var i=C(),o=a(i);xt(o,p,"default",{},null),t(d,i)},$$slots:{default:!0}}))}function Wt(y,p){const u=gt(p,["children","$$slots","$$events","$$legacy"]);ht(y,bt({name:"circle-x"},()=>u,{iconNode:[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"m15 9-6 6"}],["path",{d:"m9 9 6 6"}]],children:(d,g)=>{var i=C(),o=a(i);xt(o,p,"default",{},null),t(d,i)},$$slots:{default:!0}}))}function Ht(y,p){const u=gt(p,["children","$$slots","$$events","$$legacy"]);ht(y,bt({name:"play"},()=>u,{iconNode:[["polygon",{points:"6 3 20 12 6 21 6 3"}]],children:(d,g)=>{var i=C(),o=a(i);xt(o,p,"default",{},null),t(d,i)},$$slots:{default:!0}}))}const at=Mt({currentJob:null,jobStatus:null,jobDetails:null,taskStatusCounts:{}});async function Qt(y,p){try{const e=(await qt(y)).job_id;at.update(g=>({...g,currentJob:e,jobStatus:"started",jobDetails:null,taskStatusCounts:{}}));let d="started";for(;!["completed","failed","not_found"].includes(d);){await new Promise(o=>setTimeout(o,1e3));const g=await zt(y,e);d=g.status;let i={};if(g.task_status_map&&Object.keys(g.task_status_map).length>0&&(i=Object.values(g.task_status_map).reduce((o,j)=>(o[j]=(o[j]||0)+1,o),{})),at.set({...at,currentJob:e,jobStatus:d,jobDetails:g,taskStatusCounts:i}),d==="completed")await p();else if(d==="failed")break}}catch(u){console.error("Error:",u),at.update(e=>({...e,jobStatus:"error"}))}}var Xt=s("<!> <!> <!>",1),Yt=s('<div class="absolute top-0 h-4 bg-red-500"></div>'),Zt=s('<div class="absolute top-0 h-4 bg-yellow-500 progress-stripe svelte-i2gyqw"></div>'),te=s('<div class="absolute top-0 h-4 bg-green-600"></div>'),ee=s('<span class="inline-flex items-center gap-1"><div></div> </span>'),ae=s('<div class="text-sm text-gray-500 flex flex-wrap gap-2"></div>'),re=s('<div class="w-full bg-gray-200 rounded-sm h-4 dark:bg-gray-700 relative overflow-hidden"><div class="h-4 transition-all duration-300 bg-blue-600 relative overflow-hidden progress-stripe rounded-r-sm svelte-i2gyqw"></div> <!></div> <div class="flex justify-between mt-1 text-sm text-gray-500"><div class="flex"><!></div> <div class="flex gap-8"><span> </span> <span> </span></div></div>',1),se=s('<div class="mt-2"><!></div>'),oe=s('<div class="border rounded-lg p-4 bg-gray-50"><div class="flex items-center gap-4"><span class="font-medium">Latest Run:</span> <span> </span> <span> </span></div> <!></div>');function le(y,p){dt(p,!1);const u=mt(),e=()=>tt(at,"$jobStore",u);nt();var d=C(),g=a(d);x(g,()=>e().currentJob,i=>{var o=oe(),j=l(o),w=n(l(j),2),B=l(w,!0);D(()=>z(B,e().currentJob.slice(-8))),r(w);var k=n(w,2),G=l(k);r(k),r(j);var Q=n(j,2);x(Q,()=>e().jobDetails,X=>{var V=se(),c=l(V);x(c,()=>!e().jobDetails.task_status_map||Object.keys(e().jobDetails.task_status_map).length===0,O=>{Rt(O,{variant:"destructive",class:"mt-2",children:(F,K)=>{var P=Xt(),U=a(P);Et(U,{class:"h-4 w-4"});var R=n(U,2);At(R,{children:(v,b)=>{N();var f=M("Experiment Failed");t(v,f)},$$slots:{default:!0}});var S=n(R,2);Lt(S,{children:(v,b)=>{N();var f=M("No task status information available. The experiment may have failed to start properly.");t(v,f)},$$slots:{default:!0}}),t(F,P)},$$slots:{default:!0}})},O=>{var F=re(),K=a(F),P=l(K),U=n(P,2);x(U,()=>e().jobDetails.task_status_map,_=>{var $=C(),L=a($);pt(L,1,()=>Object.entries(e().jobDetails.task_status_map),ft,(T,h,J)=>{let W=()=>m(h)[1];var q=C(),et=a(q);x(et,()=>W()==="failed",H=>{var Y=Yt();D(()=>ot(Y,"style",`width: ${100/e().jobDetails.total_tasks}%; left: ${J/e().jobDetails.total_tasks*100}%`)),t(H,Y)},H=>{var Y=C(),ct=a(Y);x(ct,()=>W()==="evaluating",vt=>{var rt=Zt();D(()=>ot(rt,"style",`width: ${100/e().jobDetails.total_tasks}%; left: ${J/e().jobDetails.total_tasks*100}%`)),t(vt,rt)},vt=>{var rt=C(),Nt=a(rt);x(Nt,()=>W()==="completed",It=>{var yt=te();D(()=>ot(yt,"style",`width: ${100/e().jobDetails.total_tasks}%; left: ${J/e().jobDetails.total_tasks*100}%`)),t(It,yt)},null,!0),t(vt,rt)},!0),t(H,Y)}),t(T,q)}),t(_,$)}),r(K);var R=n(K,2),S=l(R),v=l(S);x(v,()=>e().jobDetails.task_status_map,_=>{var $=ae();pt($,5,()=>Object.entries(e().taskStatusCounts),ft,(L,T)=>{let h=()=>m(T)[0],J=()=>m(T)[1];var W=C(),q=a(W);x(q,()=>J()>0,et=>{var H=ee(),Y=l(H),ct=n(Y);r(H),D(()=>{Pt(Y,`w-2 h-2 rounded-full ${(h()==="completed"?"bg-green-500":h()==="running"?"bg-blue-500":h()==="evaluating"?"bg-yellow-500":h()==="failed"?"bg-red-500":"bg-gray-500")??""}`),z(ct,` ${h()??""}: ${J()??""}`)}),t(et,H)}),t(L,W)}),r($),t(_,$)}),r(S);var b=n(S,2),f=l(b),E=l(f);r(f);var I=n(f,2),A=l(I);D(()=>{var _,$;return z(A,`${(e().jobStatus==="completed"?"100":Math.round((((_=e().jobDetails)==null?void 0:_.current_task)||0)/((($=e().jobDetails)==null?void 0:$.total_tasks)||1)*100))??""}%`)}),r(I),r(b),r(R),D(()=>{var _,$;ot(P,"style",`width: ${(e().jobStatus==="completed"?"100":e().jobDetails.current_task/e().jobDetails.total_tasks*100)??""}%;`),z(E,`${(((_=e().jobDetails)==null?void 0:_.current_task)||0)??""} / ${((($=e().jobDetails)==null?void 0:$.total_tasks)||0)??""}`)}),t(O,F)}),r(V),t(X,V)}),r(o),D(()=>{Pt(k,`${`text-gray-500 ${e().jobStatus==="failed"?"text-red-500":""}`??""} svelte-i2gyqw`),z(G,`Status: ${e().jobStatus??""}`)}),t(i,o)}),t(y,d),it()}var ne=s('<div class="flex items-center gap-2"><!> <span class="text-gray-500"> </span></div>'),de=s("<!> Run Experiment",1),ie=s("<div><!></div>");function ce(y,p){dt(p,!1);const u=mt(),e=()=>tt(at,"$jobStore",u),d=()=>tt(Ct,"$selectedProjectId",u);let g=St(p,"reloadRecentRuns",8);nt();var i=ie(),o=l(i);x(o,()=>e().currentJob&&e().jobStatus&&!["completed","failed","error"].includes(e().jobStatus),j=>{var w=ne(),B=l(w);Jt(B,{class:"h-4 w-4 animate-spin"});var k=n(B,2),G=l(k,!0);r(k),r(w),D(()=>z(G,e().jobStatus)),t(j,w)},j=>{$t(j,{variant:"primary",class:"flex items-center gap-2",$$events:{click:()=>Qt(d(),g())},children:(w,B)=>{var k=de(),G=a(k);Ht(G,{class:"h-4 w-4"}),N(),t(w,k)},$$slots:{default:!0}})}),r(i),t(y,i),it()}var ve=s("<!> <!> <!>",1),ue=s("<!> <!>",1);function _e(y,p){dt(p,!1);let u=St(p,"alerts",24,()=>[]);nt();var e=C(),d=a(e);x(d,()=>u().length>0,g=>{lt(g,{children:(i,o)=>{var j=ue(),w=a(j);ut(w,{children:(k,G)=>{_t(k,{children:(Q,X)=>{N();var V=M("Key Alerts and Notifications");t(Q,V)},$$slots:{default:!0}})},$$slots:{default:!0}});var B=n(w,2);Dt(B,{class:"space-y-4",children:(k,G)=>{var Q=C(),X=a(Q);pt(X,1,u,ft,(V,c)=>{var O=Ot(()=>m(c).type==="improvement"?"default":"destructive");Rt(V,{get variant(){return m(O)},children:(F,K)=>{var P=ve(),U=a(P);x(U,()=>m(c).type==="regression",v=>{Et(v,{class:"h-4 w-4"})},v=>{var b=C(),f=a(b);x(f,()=>m(c).type==="security",E=>{Wt(E,{class:"h-4 w-4"})},E=>{var I=C(),A=a(I);x(A,()=>m(c).type==="improvement",_=>{Vt(_,{class:"h-4 w-4"})},null,!0),t(E,I)},!0),t(v,b)});var R=n(U,2);At(R,{children:(v,b)=>{N();var f=M();D(()=>z(f,m(c).type.charAt(0).toUpperCase()+m(c).type.slice(1))),t(v,f)},$$slots:{default:!0}});var S=n(R,2);Lt(S,{children:(v,b)=>{N();var f=M();D(()=>z(f,m(c).message)),t(v,f)},$$slots:{default:!0}}),t(F,P)},$$slots:{default:!0}})}),t(k,Q)},$$slots:{default:!0}}),t(i,j)},$$slots:{default:!0}})}),t(y,e),it()}var $e=s('<div class="flex items-center justify-center h-[50vh] text-gray-500"><div class="flex items-center gap-2"><!> <span>Loading project details...</span></div></div>'),pe=s(' <p class="pt-1">Check if API is running</p>',1),fe=s("<!> <!>",1),me=s("<!> <!>",1),ge=s('<div class="flex items-center justify-center h-[50vh] text-gray-500"><!></div>'),be=s("<!> <!>",1),he=s("<!> <!>",1),xe=s('<div class="flex items-center justify-center h-[50vh] text-gray-500"><!></div>'),ye=s('<span class="text-md font-medium">Total Runs</span> <div class="text-2xl font-bold"> </div>',1),je=s('<div class="flex justify-between items-center"><h1 class="text-3xl font-bold -mb-2 -mt-2"> </h1> <!></div> <!> <div class="grid grid-cols-1 md:grid-cols-3 gap-4"><!></div> <!> <!>',1),we=s('<div class="container mx-auto p-4 space-y-6"><!></div>');function Te(y,p){dt(p,!1);const u=mt(),e=()=>tt(Ut,"$projects",u),d=()=>tt(Ct,"$selectedProjectId",u),g=()=>tt(Ft,"$projectsLoading",u),i=()=>tt(Kt,"$projectsError",u),o=st();let j=st([]),w=st(null),B=st(!1),k=st(0);async function G(){Z(B,!0),Z(w,null);try{const c=await Bt(d());Z(j,c.runs),Z(k,c.total)}catch(c){console.error("Error loading recent runs:",c),Z(w,c instanceof Error?c.message:"Unknown error")}finally{Z(B,!1)}}const Q=[];jt(()=>(e(),d()),()=>{Z(o,e().find(c=>c.id===d()))}),jt(()=>m(o),()=>{m(o)&&G()}),Tt(),nt();var X=we(),V=l(X);x(V,g,c=>{var O=$e(),F=l(O),K=l(F);Jt(K,{class:"h-6 w-6 animate-spin"}),N(2),r(F),r(O),t(c,O)},c=>{var O=C(),F=a(O);x(F,i,K=>{var P=ge(),U=l(P);lt(U,{class:"border-red-200 bg-red-50 w-96",children:(R,S)=>{var v=me(),b=a(v);ut(b,{children:(E,I)=>{var A=fe(),_=a(A);_t(_,{class:"text-red-800",children:(L,T)=>{N();var h=M("Error");t(L,h)},$$slots:{default:!0}});var $=n(_,2);wt($,{class:"text-red-600",children:(L,T)=>{N();var h=pe(),J=a(h);N(),D(()=>z(J,`${i()??""} `)),t(L,h)},$$slots:{default:!0}}),t(E,A)},$$slots:{default:!0}});var f=n(b,2);kt(f,{class:"flex justify-end",children:(E,I)=>{$t(E,{variant:"outline",class:"border-red-200 text-red-800 hover:bg-red-100",$$events:{click:()=>window.location.reload()},children:(A,_)=>{N();var $=M("Try Again");t(A,$)},$$slots:{default:!0}})},$$slots:{default:!0}}),t(R,v)},$$slots:{default:!0}}),r(P),t(K,P)},K=>{var P=C(),U=a(P);x(U,()=>!m(o),R=>{var S=xe(),v=l(S);lt(v,{class:"border-yellow-200 bg-yellow-50 w-96 space-y-4",children:(b,f)=>{var E=he(),I=a(E);ut(I,{children:(_,$)=>{var L=be(),T=a(L);_t(T,{class:"text-yellow-800",children:(J,W)=>{N();var q=M("Project Not Found");t(J,q)},$$slots:{default:!0}});var h=n(T,2);wt(h,{class:"text-yellow-600 pt-2",children:(J,W)=>{N();var q=M();D(()=>z(q,`The project "${d()??""}" could not be found.`)),t(J,q)},$$slots:{default:!0}}),t(_,L)},$$slots:{default:!0}});var A=n(I,2);kt(A,{class:"flex justify-end",children:(_,$)=>{$t(_,{variant:"outline",class:"border-yellow-200 text-yellow-800 hover:bg-yellow-100",$$events:{click:()=>window.location.href="/"},children:(L,T)=>{N();var h=M("Go Back");t(L,h)},$$slots:{default:!0}})},$$slots:{default:!0}}),t(b,E)},$$slots:{default:!0}}),r(S),t(R,S)},R=>{var S=je(),v=a(S),b=l(v),f=l(b,!0);r(b);var E=n(b,2);ce(E,{reloadRecentRuns:G}),r(v);var I=n(v,2);le(I,{});var A=n(I,2),_=l(A);lt(_,{children:(T,h)=>{Dt(T,{class:"flex items-center justify-between py-4",children:(J,W)=>{var q=ye(),et=n(a(q),2),H=l(et,!0);r(et),D(()=>z(H,m(k))),t(J,q)},$$slots:{default:!0}})},$$slots:{default:!0}}),r(A);var $=n(A,2);Gt($,{get runsList(){return m(j)},get isLoading(){return m(B)},get loadingError(){return m(w)},showViewAll:!0});var L=n($,2);_e(L,{alerts:Q}),D(()=>z(f,m(o).name)),t(R,S)},!0),t(K,P)},!0),t(c,O)}),r(X),t(y,X),it()}export{Te as component};
