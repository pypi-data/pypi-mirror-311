{% extends base_template_path %}
{% load partials %}
{% load nominopolitan %}

{% block content %}
    {% partial content %}
{% endblock %}

{% partialdef content %}
    <title id="header_title">{{header_title}}</title>
    <div class="is-flex is-flex-direction-column m-2 p-2">
        <h1 class="is-flex-grow-1 title is-4">{{ object_verbose_name_plural|capfirst }}</h1>
        {% if create_view_url %}
            <div class="mt-2">
                {% if use_htmx and htmx_target %}
                <a class="button is-primary" href="{{ create_view_url }}"
                hx-get="{{ create_view_url }}" hx-target="{{htmx_target}}" hx-replace-url="true" hx-push-url="true"
                >
                    Add a new {{ object_verbose_name }}
                </a>
                {% else %}
                <a class="button is-primary" href="{{ create_view_url }}">
                    Add a new {{ object_verbose_name }}
                </a>
                {% endif %}
            </div>
        {% endif %}
        {% if object_list %}
            {% object_list object_list view %}
        {% else %}
            <p class="mt-4">There are no {{ object_verbose_name_plural }}. Create one now?</p>
        {% endif %}
    </div>
    <hr>
    <div id="crud_target"></div>
    {% partial crud_modal %}
{% endpartialdef content %}

{% partialdef crud_modal %}
<div x-data="{ modalOpen: false }" id="baseModal" {% if use_modal %}@show-modal.window="modalOpen = true" {% endif %}>
    <div class="modal" :class="{ 'is-active': modalOpen }">
        <div class="modal-background" @click="modalOpen = false"></div>
        <div class="modal-content">
            <div class="box" style="position: relative;">
                <button class="delete is-large" aria-label="close" @click="modalOpen = false"
                    style="position: absolute; top: 0.5rem; right: 0.5rem;"></button>
                <div id="modalContent" {% if use_modal %} hx-trigger="htmx:afterSwap"
                    hx-on::after-swap="window.dispatchEvent(new Event('show-modal'))" {% endif %}>
                </div>
            </div>
        </div>
    </div>
</div>
{% endpartialdef crud_modal %}

