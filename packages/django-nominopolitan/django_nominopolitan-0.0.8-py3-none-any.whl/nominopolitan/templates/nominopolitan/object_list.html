{% extends base_template_path %}
{% load partials %}
{% load nominopolitan %}

{% block content %}
    {% partial content %}
{% endblock %}

{% partialdef content %}
    <title id="header_title">{{header_title}}</title>
    <div class="is-flex is-flex-direction-column m-2 p-2">
        <h1 class="is-flex-grow-1 title is-4">{{ object_verbose_name_plural|capfirst }}</h1>
        {% if create_view_url %}
            <div class="mt-2">
                {% if use_htmx and htmx_target %}
                <a class="button is-primary" href="{{ create_view_url }}"
                hx-get="{{ create_view_url }}" hx-target="#{{htmx_target}}" hx-replace-url="true" hx-push-url="true"
                >
                    Add a new {{ object_verbose_name }}
                </a>
                {% else %}
                <a class="button is-primary" href="{{ create_view_url }}">
                    Add a new {{ object_verbose_name }}
                </a>
                {% endif %}
            </div>
        {% endif %}
        {% if object_list %}
            {% object_list object_list view %}
        {% else %}
            <p class="mt-4">There are no {{ object_verbose_name_plural }}. Create one now?</p>
        {% endif %}
    </div>
    <hr>
    <div id="crud_target"></div>
    {% partial crud_modal %}
{% endpartialdef content %}

{% partialdef crud_modal %}
<div class="modal" id="baseModal" :class="{ 'is-active': modalOpen }">
    <!-- Dynamically adds 'is-active' class to show/hide modal based on modalOpen state -->

    <!-- Closes the modal when the background is clicked -->
    <div class="modal-background" @click="modalOpen = false">
    </div>

    <div class="modal-card is-wide">
        <header class="modal-card-head has-background-primary">
            <p class="modal-card-title is-wrappable has-text-white" id="modalTitle">
                <!-- Placeholder for modal title; can be overridden in child templates -->
                {% block modal_title %}{% endblock modal_title %}
            </p>
            <button class="delete" aria-label="close" @click="modalOpen = false"></button>
            <!-- Closes the modal when clicked -->
        </header>

        <section class="modal-card-body">
            <div class="content" id="modalContent">
                {% block modal_content %}{% endblock modal_content %}
            </div>
        </section>

        <footer class="modal-card-foot">
            <div class="buttons" id="modalButtons">
                {% block modal_buttons %}
                {# will be overridden when used. Example shows how to close the modal #}
                <button class="button is-link" @click="modalOpen = false">
                    Close
                </button>
                {% endblock modal_buttons %}
            </div>
        </footer>
    </div>
</div>
{% endpartialdef crud_modal %}