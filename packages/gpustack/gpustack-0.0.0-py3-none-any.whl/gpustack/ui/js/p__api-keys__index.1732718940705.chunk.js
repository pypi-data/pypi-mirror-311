"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4674],{56838:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(35453),a=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"},s=n(52273),i=function(e,t){return a.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var c=a.forwardRef(i)},42034:function(e,t,n){var r=n(26068),a=n.n(r),o=n(48305),s=n.n(o),i=n(5268),c=n(26268),l=n(99178),u=n(70109),d=n(23333),f=n(85885),p=n(99013),m=n.n(p),h=n(50959),x=n(11527);t.Z=function(e){var t=e.text,n=e.disabled,r=e.type,o=void 0===r?"text":r,p=e.shape,v=void 0===p?"default":p,g=e.fontSize,y=void 0===g?"14px":g,Z=e.style,b=e.size,j=void 0===b?"middle":b,k=(0,l.useIntl)(),w=(0,h.useState)(!1),M=s()(w,2),C=M[0],S=M[1],I=(0,h.useRef)(null),E=(0,h.useRef)(null);return(0,h.useEffect)((function(){return I.current&&(E.current=new(m())(I.current),E.current.on("success",(function(){S(!0),setTimeout((function(){S(!1)}),3e3)})),E.current.on("error",(function(e){u.ZP.success(k.formatMessage({id:"common.copy.fail"})),e.clearSelection()}))),function(){var e;null===(e=E.current)||void 0===e||e.destroy()}}),[I]),(0,x.jsx)(d.Z,{title:k.formatMessage({id:"common.button.copy"}),children:(0,x.jsx)(f.ZP,{className:"copy-button",ref:I,type:o,shape:v,size:j,disabled:!!n,"data-clipboard-text":t,icon:C?(0,x.jsx)(i.Z,{style:{color:"var(--ant-color-success)",fontSize:y}}):(0,x.jsx)(c.Z,{style:a()({fontSize:y},Z)})})})}},42779:function(e,t,n){var r=n(26068),a=n.n(r),o=n(48305),s=n.n(o),i=n(67825),c=n.n(i),l=n(71239),u=n(99178),d=n(68476),f=n(60857),p=n(32699),m=n(50959),h=n(36134),x=n(11527),v=["label","placeholder","children","required","description","options","isInFormItems"];t.Z=function(e){var t=e.label,n=(e.placeholder,e.children),r=e.required,o=e.description,i=e.options,g=e.isInFormItems,y=void 0===g||g,Z=c()(e,v),b=(0,u.useIntl)(),j=(0,m.useState)(!1),k=s()(j,2),w=k[0],M=k[1],C=(0,m.useRef)(null),S="";if(y){var I,E,T=null===d.Z||void 0===d.Z||null===(I=d.Z.Item)||void 0===I||null===(E=I.useStatus)||void 0===E?void 0:E.call(I);S=(null==T?void 0:T.status)||""}var O=(0,m.useMemo)((function(){return null!=i&&i.length?(0,p.cloneDeep)(i).map((function(e){return e.locale&&(e.label=b.formatMessage({id:e.label})),e})):[]}),[i,b]);(0,m.useEffect)((function(){(0,l.JL)(e.value)&&M(!0)}),[e.value]);return(0,x.jsx)(h.Z,{status:S,label:t,isFocus:w,required:r,description:o,disabled:e.disabled,onClick:function(){var t,n;e.disabled||w||(null===(t=C.current)||void 0===t||null===(n=t.focus)||void 0===n||n.call(t),M(!0))},children:(0,x.jsx)(f.default,a()(a()({},Z),{},{ref:C,options:O,onFocus:function(t){var n;M(!0),null===(n=e.onFocus)||void 0===n||n.call(e,t)},onBlur:function(t){var n;e.value||M(!1),null===(n=e.onBlur)||void 0===n||n.call(e,t)},onChange:function(t,n){var r;(0,l.JL)(t)?M(!0):M(!1),null===(r=e.onChange)||void 0===r||r.call(e,t,n)},notFoundContent:null,children:n}))})}},85599:function(e,t,n){n.r(t),n.d(t,{default:function(){return $}});var r=n(90228),a=n.n(r),o=n(87999),s=n.n(o),i=n(26068),c=n.n(i),l=n(48305),u=n.n(l),d=n(33883),f=n(94186),p=n(40198),m=n(12526),h=n(93495),x=n(34531),v=n(51980),g=n(71239),y=n(56838),Z=n(19019),b=n(69070),j=n(55169),k=n(99178),w=n(9281),M=n(54235),C=n(8267),S=n(85885),I=n(23333),E=n(7672),T=n.n(E),O=n(32699),P=n.n(O),z=n(50959),q=n(94299),F="/api-keys";function R(e){return A.apply(this,arguments)}function A(){return(A=s()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,k.request)("".concat(F),{method:"GET",params:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e){return D.apply(this,arguments)}function D(){return(D=s()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,k.request)("".concat(F),{method:"POST",data:t.data}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e){return L.apply(this,arguments)}function L(){return(L=s()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,k.request)("".concat(F,"/").concat(t),{method:"DELETE"}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var _=n(42034),B=n(7215),H=n(92233),J=n(42779),G=n(68476),N=n(1956),V=n(76808),W=[{label:"apikeys.form.expiration.7days",type:"day",value:7,locale:!0},{label:"apikeys.form.expiration.1month",type:"month",value:1,locale:!0},{label:"apikeys.form.expiration.6months",type:"month",value:6,locale:!0},{label:"apikeys.form.expiration.never",type:"never",value:-1,locale:!0}],Q=n(11527),U=function(e){var t=e.title,n=e.action,r=e.open,o=e.onOk,i=e.onCancel,l=G.Z.useForm(),d=u()(l,1)[0],f=(0,k.useIntl)(),p=(0,z.useState)(!1),h=u()(p,2),x=h[0],v=h[1],g=(0,z.useState)(""),y=u()(g,2),Z=y[0],b=y[1],j=(0,z.useState)(!1),w=u()(j,2),M=w[0],C=w[1];(0,z.useEffect)((function(){n===m.Kd.CREATE&&r&&d.setFieldsValue({expires_in:1})}),[r]);var I=function(e){var t=e;if(-1===t)return 0;var n=W.find((function(e){return t===e.value})),r=T()().add(null==n?void 0:n.value,"".concat(null==n?void 0:n.type)),a=T()();return r.diff(a,"second")},E=function(){var e=s()(a()().mark((function e(t){var n,r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,C(!0),n=c()(c()({},t),{},{expires_in:I(t.expires_in)}),e.next=5,Y({data:n});case 5:r=e.sent,b(r.value),v(!0),C(!1),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),C(!1);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),O=function(){d.submit()};return(0,Q.jsx)(N.Z,{title:x?f.formatMessage({id:"apikeys.title.save"}):t,open:r,centered:!0,onOk:O,onCancel:i,afterOpenChange:function(e){v(!1)},destroyOnClose:!0,closeIcon:!1,maskClosable:!1,keyboard:!1,width:600,styles:{},footer:x?(0,Q.jsx)(S.ZP,{type:"primary",onClick:function(){o()},children:f.formatMessage({id:"common.button.done"})}):(0,Q.jsx)(B.Z,{onOk:O,onCancel:i,loading:M}),children:(0,Q.jsx)(G.Z,{name:"addAPIKey",form:d,onFinish:E,preserve:!1,children:x?(0,Q.jsxs)(G.Z.Item,{children:[(0,Q.jsx)("div",{children:(0,Q.jsx)(V.Z,{bordered:!1,color:"error",style:{padding:"6px 8px",marginBottom:16},children:f.formatMessage({id:"apikeys.table.save.tips"})})}),(0,Q.jsx)(H.Z.Input,{label:f.formatMessage({id:"apikeys.form.apikey"}),value:Z,addAfter:(0,Q.jsx)(_.Z,{text:Z,shape:"default",size:"middle",type:"text"})})]}):(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(G.Z.Item,{name:"name",rules:[{required:!0,message:f.formatMessage({id:"common.form.rule.input"},{name:f.formatMessage({id:"common.table.name"})})}],children:(0,Q.jsx)(H.Z.Input,{label:f.formatMessage({id:"common.table.name"}),required:!0})}),(0,Q.jsx)(G.Z.Item,{name:"expires_in",rules:[{required:!0,message:f.formatMessage({id:"common.form.rule.select"},{name:f.formatMessage({id:"apikeys.form.expiretime"})})}],children:(0,Q.jsx)(J.Z,{options:W,label:f.formatMessage({id:"apikeys.form.expiretime"}),required:!0})}),(0,Q.jsx)(G.Z.Item,{name:"description",rules:[{required:!1}],children:(0,Q.jsx)(H.Z.TextArea,{label:f.formatMessage({id:"common.table.description"})})})]})})})},X=w.Z.Column,$=function(){var e=(0,x.Z)(),t=(0,v.Z)({defaultSortOrder:"descend"}),n=t.sortOrder,r=t.setSortOrder,o=(0,k.useIntl)(),i=(0,z.useRef)(null),l=(0,z.useState)({dataList:[],loading:!1,total:0}),E=u()(l,2),O=E[0],F=E[1],A=(0,z.useState)(!1),Y=u()(A,2),D=Y[0],L=Y[1],_=(0,z.useState)(m.Kd.CREATE),B=u()(_,2),H=B[0],J=B[1],G=(0,z.useState)({page:1,perPage:10,search:""}),N=u()(G,2),V=N[0],W=N[1],$=function(){var e=s()(a()().mark((function e(){var t,n;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F((function(e){return e.loading=!0,c()({},e)})),e.prev=1,t=c()({},P().pickBy(V,(function(e){return!!e}))),e.next=5,R(t);case 5:n=e.sent,F({dataList:n.items||[],loading:!1,total:n.pagination.total}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),F({dataList:[],loading:!1,total:O.total});case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),ee=function(){L(!0),J(m.Kd.CREATE)},te=function(){var e=s()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$();case 3:L(!1),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}();return(0,z.useEffect)((function(){$()}),[V]),(0,q.y1)(h.ZP.CREATE,(function(){ee()}),{enabled:!D}),(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsxs)(j._z,{ghost:!0,header:{title:o.formatMessage({id:"apikeys.title"})},extra:[],children:[(0,Q.jsx)(p.Z,{marginBottom:22,left:(0,Q.jsxs)(M.Z,{children:[(0,Q.jsx)(C.Z,{placeholder:o.formatMessage({id:"common.filter.name"}),style:{width:300},allowClear:!0,onChange:function(e){W(c()(c()({},V),{},{search:e.target.value}))}}),(0,Q.jsx)(S.ZP,{type:"text",style:{color:"var(--ant-color-text-tertiary)"},onClick:function(e){$()},icon:(0,Q.jsx)(y.Z,{})})]}),right:(0,Q.jsxs)(M.Z,{size:20,children:[(0,Q.jsx)(S.ZP,{icon:(0,Q.jsx)(Z.Z,{}),type:"primary",onClick:ee,children:o.formatMessage({id:"apikeys.button.create"})}),(0,Q.jsx)(S.ZP,{icon:(0,Q.jsx)(b.Z,{}),danger:!0,onClick:function(){i.current.show({content:"apikeys.table.apikeys",selection:!0,onOk:function(){return s()(a()().mark((function t(){return a()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,g.D6)(e.selectedRowKeys,K);case 2:e.clearSelections(),$();case 4:case"end":return t.stop()}}),t)})))()}})},disabled:!e.selectedRowKeys.length,children:o.formatMessage({id:"common.button.delete"})})]})}),(0,Q.jsxs)(w.Z,{dataSource:O.dataList,rowSelection:e,loading:O.loading,rowKey:"id",onChange:function(e,t,n){r(n.order)},pagination:{showSizeChanger:!0,pageSize:V.perPage,current:V.page,total:O.total,hideOnSinglePage:10===V.perPage,onChange:function(e,t){W(c()(c()({},V),{},{page:e,perPage:t||10}))}},children:[(0,Q.jsx)(X,{title:o.formatMessage({id:"common.table.name"}),dataIndex:"name",ellipsis:{showTitle:!1},render:function(e,t){return(0,Q.jsx)(d.Z,{ghost:!0,style:{maxWidth:400},children:e})}},"name"),(0,Q.jsx)(X,{title:o.formatMessage({id:"apikeys.form.expiretime"}),dataIndex:"expires_at",ellipsis:{showTitle:!1},render:function(e,t){return(0,Q.jsx)(d.Z,{ghost:!0,children:e?T()(e).format("YYYY-MM-DD HH:mm:ss"):o.formatMessage({id:"apikeys.form.expiration.never"})})}},"expiration"),(0,Q.jsx)(X,{title:o.formatMessage({id:"common.table.description"}),dataIndex:"description",ellipsis:{showTitle:!1},render:function(e,t){return(0,Q.jsx)(d.Z,{ghost:!0,children:e})}},"description"),(0,Q.jsx)(X,{title:o.formatMessage({id:"common.table.createTime"}),dataIndex:"created_at",defaultSortOrder:"descend",sortOrder:n,showSorterTooltip:!1,sorter:!1,ellipsis:{showTitle:!1},render:function(e,t){return(0,Q.jsx)(d.Z,{ghost:!0,children:T()(e).format("YYYY-MM-DD HH:mm:ss")})}},"createTime"),(0,Q.jsx)(X,{title:o.formatMessage({id:"common.table.operation"}),ellipsis:{showTitle:!1},render:function(e,t){return(0,Q.jsx)(M.Z,{size:20,children:(0,Q.jsx)(I.Z,{title:o.formatMessage({id:"common.button.delete"}),children:(0,Q.jsx)(S.ZP,{onClick:function(){return e=t,void i.current.show({content:"apikeys.table.apikeys",name:e.name,onOk:function(){return s()(a()().mark((function t(){return a()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,K(e.id);case 3:$();case 4:case"end":return t.stop()}}),t)})))()}});var e},size:"small",danger:!0,icon:(0,Q.jsx)(b.Z,{})})})})}},"operation")]})]}),(0,Q.jsx)(U,{open:D,action:H,title:o.formatMessage({id:"apikeys.button.create"}),onCancel:function(){L(!1)},onOk:te}),(0,Q.jsx)(f.Z,{ref:i})]})}}}]);