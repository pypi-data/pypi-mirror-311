"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8394],{76483:function(e,n,t){var a=t(82092),r=t.n(a),l=t(26068),s=t.n(l),i=t(48305),u=t.n(i),o=t(75489),c=t(92233),d=t(42779),p=t(13770),m=t(4423),f=t(99178),v=t(68476),x=t(23333),h=t(40474),y=t(96247),g=t(32699),b=t.n(g),j=t(50959),w=t(26938),k=t(11527),Z=(0,j.forwardRef)((function(e,n){var t=e.setParams,a=e.onValuesChange,l=e.onModelChange,i=e.parametersTitle,g=e.selectedModel,Z=e.globalParams,C=e.initialValues,N=e.paramsConfig,S=e.modelList,z=e.params,M=e.showModelSelector,R=void 0===M||M,L=e.extra,I=(0,f.useIntl)(),_=v.Z.useForm(),F=u()(_,1)[0],T=(0,j.useId)();(0,j.useImperativeHandle)(n,(function(){return{form:F}})),(0,j.useEffect)((function(){R?(F.setFieldsValue(s()({model:g||b().get(S,"[0].value")},C)),t(s()({model:g||b().get(S,"[0].value")},C))):(F.setFieldsValue(s()({model:g||""},C)),t(s()({model:g||""},C)))}),[S,R,g,C]);var E=(0,j.useCallback)((function(e){null==l||l(e)}),[l]),A=(0,j.useCallback)((function(e,n){null==t||t(n),null==a||a(e,n)}),[a,t]),P=(0,j.useCallback)((function(e,n){var l=F.getFieldsValue();F.setFieldsValue(s()(s()({},l),{},r()({},n,e))),t(s()(s()({},l),{},r()({},n,e))),null==a||a(r()({},n,e),s()(s()({},l),{},r()({},n,e)))}),[F,t,a]);(0,j.useEffect)((function(){F.setFieldsValue(Z)}),[Z]);var q=(0,j.useCallback)((function(e){return(0,k.jsxs)("span",{className:w.Z.label,style:{width:p.d.mini},children:[(0,k.jsx)("span",{className:"text",children:e.description?(0,k.jsxs)(x.Z,{title:e.description,children:[(0,k.jsxs)("span",{children:[" ",e.label]}),(0,k.jsx)("span",{className:"m-l-5",children:(0,k.jsx)(m.Z,{})})]}):(0,k.jsx)("span",{children:e.label})}),(0,k.jsx)(h.Z,{className:"label-val",variant:"outlined",size:"small",value:F.getFieldValue(e.field),controls:!1,onChange:function(n){return P(n,e.field)}})]})}),[F,P]),D=(0,j.useMemo)((function(){return null!=N&&N.length?N.map((function(e){return"InputNumber"===e.type?(0,k.jsx)(v.Z.Item,{name:e.name,rules:e.rules,children:(0,k.jsx)(c.Z.Number,s()(s()({},e.attrs),{},{style:{width:"100%"},label:e.label.isLocalized?I.formatMessage({id:e.label.text}):e.label.text}))},e.name):"TextArea"===e.type?(0,k.jsx)(v.Z.Item,{name:e.name,rules:e.rules,children:(0,k.jsx)(c.Z.TextArea,s()(s()({},e.attrs),{},{style:{width:"100%"},label:e.label.isLocalized?I.formatMessage({id:e.label.text}):e.label.text}))},e.name):"Select"===e.type?(0,k.jsx)(v.Z.Item,{name:e.name,rules:e.rules,children:(0,k.jsx)(d.Z,s()(s()({},e.attrs),{},{options:e.options,label:e.label.isLocalized?I.formatMessage({id:e.label.text}):e.label.text}))},e.name):"Slider"===e.type?(0,k.jsx)(v.Z.Item,{name:e.name,rules:e.rules,children:(0,k.jsx)(o.Z,{label:q({field:e.name,label:e.label.isLocalized?I.formatMessage({id:e.label.text}):e.label.text,description:null!==(n=e.description)&&void 0!==n&&n.isLocalized?I.formatMessage({id:null===(t=e.description)||void 0===t?void 0:t.text}):(null===(a=e.description)||void 0===a?void 0:a.text)||""}),style:{padding:"20px 2px 0"},variant:"borderless",children:(0,k.jsx)(y.Z,s()(s()({},e.attrs),{},{style:{marginBottom:0,marginTop:16,marginInline:0},tooltip:{open:!1},value:F.getFieldValue(e.name)||void 0,onChange:function(n){return P(n,e.name)}}))})},e.name):null;var n,t,a})):null}),[N,z,I]);return(0,k.jsx)(v.Z,{name:T,form:F,onValuesChange:A,onFinish:function(e){},onFinishFailed:function(e){},children:(0,k.jsxs)("div",{children:[(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("h3",{className:"m-b-20 m-l-10 font-size-14 line-24",children:i||(0,k.jsx)("span",{children:I.formatMessage({id:"playground.parameters"})})}),(0,k.jsx)(v.Z.Item,{name:"model",rules:[{required:!0,message:I.formatMessage({id:"common.form.rule.select"},{name:I.formatMessage({id:"playground.model"})})}],children:(0,k.jsx)(d.Z,{onChange:E,showSearch:!0,options:S,label:I.formatMessage({id:"playground.model"})})})]}),D,L]})})}));n.Z=(0,j.memo)(Z)},79961:function(e,n,t){t.d(n,{Z:function(){return m}});var a=t(78093),r=t(99178),l=t(87497),s=t(23333),i=t(54235),u=t(82187),o=t.n(u),c=t(32699),d=t.n(c),p=t(11527),m=function(e){var n=(0,r.useIntl)(),t=e.usage,u=e.showOutput,c=void 0===u||u,m=e.scaleable,f=e.fields,v=void 0===f?["completion_tokens","prompt_tokens"]:f;return!t||d().isEmpty(t)?null:t.error?(0,p.jsxs)(l.Z.Paragraph,{type:"danger",ellipsis:{rows:2,tooltip:null==t?void 0:t.errorMessage},style:{textAlign:"center",paddingBlock:0,margin:0,backgroundColor:"var(--ant-color-error-bg)"},children:[(0,p.jsx)(a.Z,{className:"m-r-8"}),null==t?void 0:t.errorMessage]}):(0,p.jsxs)("div",{className:o()("reference-params",{scaleable:m}),children:[(0,p.jsx)("span",{className:o()("usage",{scaleable:m}),children:(0,p.jsx)(s.Z,{title:(0,p.jsxs)(i.Z,{children:[v.includes("completion_tokens")&&(0,p.jsxs)("span",{children:[n.formatMessage({id:"playground.completion"}),":"," ",t.completion_tokens]}),v.includes("prompt_tokens")&&(0,p.jsxs)("span",{children:[n.formatMessage({id:"playground.prompt"}),":"," ",t.prompt_tokens]})]}),children:(0,p.jsxs)("span",{children:[n.formatMessage({id:"playground.tokenusage"}),":"," ",t.total_tokens]})})}),c&&(0,p.jsx)("span",{className:o()("usage",{scaleable:m}),children:(0,p.jsx)(s.Z,{title:(0,p.jsxs)(i.Z,{children:[(0,p.jsxs)("span",{children:["TPOT: ",d().round(t.time_per_output_token_ms,2)||0," ms"]}),(0,p.jsxs)("span",{children:["TTFT: ",d().round(t.time_to_first_token_ms,2)||0," ms"]})]}),children:(0,p.jsxs)("span",{children:[n.formatMessage({id:"playground.tokenoutput"}),":"," ",d().round(t.tokens_per_second,2)||0," Tokens/s"]})})})]})}},22471:function(e,n,t){t.d(n,{FM:function(){return l},GF:function(){return i},I_:function(){return a},JY:function(){return r},QU:function(){return s}});var a=[{type:"Select",name:"voice",options:[],label:{text:"playground.params.voice",isLocalized:!0},rules:[{required:!0,message:"Voice is required"}]},{type:"Select",name:"response_format",options:[{label:"mp3",value:"mp3"},{label:"opus",value:"opus"},{label:"aac",value:"aac"},{label:"flac",value:"flac"},{label:"wav",value:"wav"},{label:"pcm",value:"pcm"}],label:{text:"playground.params.format",isLocalized:!0},rules:[{required:!1}]},{type:"Select",name:"speed",options:[{label:"0.25x",value:.25},{label:"0.5x",value:.5},{label:"1x",value:1},{label:"2x",value:2},{label:"4x",value:4}],label:{text:"playground.params.speed",isLocalized:!0},rules:[{required:!1}]}],r=[{type:"Select",name:"language",options:[{label:"Auto",value:"auto"},{label:"English",value:"en"},{label:"中文",value:"zh"},{label:"日本語",value:"ja"},{label:"Français",value:"fr"},{label:"Deutsch",value:"de"}],label:{text:"playground.params.language",isLocalized:!0},rules:[{required:!0}]}],l=[{type:"InputNumber",name:"n",label:{text:"playground.params.counts",isLocalized:!0},attrs:{min:1,max:4},rules:[{required:!1}]},{type:"Select",name:"size",options:[{label:"playground.params.custom",value:"custom",locale:!0},{label:"256x256",value:"256x256"},{label:"512x512",value:"512x512"},{label:"1024x1024",value:"1024x1024"},{label:"1792x1024",value:"1792x1024"},{label:"1024x1792",value:"1024x1792"}],label:{text:"playground.params.size",isLocalized:!0},rules:[{required:!1}]}],s=[{type:"Select",name:"quality",options:[{label:"playground.params.standard",value:"standard",locale:!0},{label:"playground.params.hd",value:"hd",locale:!0}],label:{text:"playground.params.quality",isLocalized:!0},rules:[{required:!1}]},{type:"Select",name:"style",options:[{label:"playground.params.style.vivid",value:"vivid",locale:!0},{label:"playground.params.style.natural",value:"natural",locale:!0}],attrs:{allowClear:!0},label:{text:"playground.params.style",isLocalized:!0},rules:[{required:!1}]}],i=[{type:"Select",name:"sampler",options:[{label:"euler_a",value:"euler_a"},{label:"euler",value:"euler"},{label:"heun",value:"heun"},{label:"dpm2",value:"dpm2"},{label:"dpm++2s_a",value:"dpm++2s_a"},{label:"dpm++2m",value:"dpm++2m"},{label:"dpm++2mv2",value:"dpm++2mv2"},{label:"ipndm",value:"ipndm"},{label:"pndm_v",value:"pndm_v"},{label:"lcm",value:"lcm"}],label:{text:"playground.image.params.sampler",isLocalized:!0},rules:[{required:!1}]},{type:"InputNumber",name:"sample_steps",label:{text:"playground.image.params.samplerSteps",isLocalized:!0},attrs:{min:1,max:100,defaultValue:10},rules:[{required:!1}]},{type:"InputNumber",name:"cfg_scale",label:{text:"CFG Scale",isLocalized:!1},attrs:{min:1,max:10,step:.1,defaulValue:4.5},rules:[{required:!1}]},{type:"Input",name:"negative_prompt",label:{text:"playground.image.params.negativePrompt",isLocalized:!0},rules:[{required:!1}]},{type:"InputNumber",name:"seed",label:{text:"playground.image.params.seed",isLocalized:!0},rules:[{required:!1}]}]},20033:function(e,n,t){t.r(n),t.d(n,{default:function(){return Ne}});var a=t(90228),r=t.n(a),l=t(87999),s=t.n(l),i=t(48305),u=t.n(i),o=t(83057),c=t(35445),d=t(93495),p=t(55592),m=t(6555),f=t(55169),v=t(99178),x=t(54235),h=t(85885),y=t(96938),g=t(47946),b=t(82187),j=t.n(b),w=t(32699),k=t.n(w),Z=t(50959),C=t(94299),N=t(35014),S=t(26068),z=t.n(S),M=t(11527),R=function(e){var n=e.width,t=e.height,a=e.analyserData,r=Z.useRef(null),l=Z.useRef(0),s=Z.useRef(!1),i=Z.useRef(0),u=Z.useRef(1);return(0,Z.useEffect)((function(){var e,o;return null!==(e=a.data)&&void 0!==e&&e.length&&a.analyser.current?(function(){var e;if(r.current&&null!==(e=a.data)&&void 0!==e&&e.length){var o=r.current,c=o.getContext("2d");if(c){var d=o.width=2*n,p=o.height=2*t;s.current||(c.scale(2,2),s.current=!0);var m=p/2,f=Math.floor(p/2),v=0;c.fillStyle="#0073EF",function e(){var n;if(++v%2==0){null===(n=a.analyser)||void 0===n||null===(n=n.current)||void 0===n||n.getByteFrequencyData(a.data),c.clearRect(0,0,d,p);var t=a.data.length,r=m-(5*t-2)/2+i.current;i.current+=.5*u.current,(i.current>20||i.current<-20)&&(u.current*=-1);for(var s=0;s<t;s++){var o=Math.floor(a.data[s]/2)+(15+Math.round(45*(Math.random()-.5))),x=Math.round(f-o/2),h=Math.round(f+o/2);c.beginPath(),c.moveTo(r,h),c.lineTo(r,x+2),c.arcTo(r+3,x+2,r+3,h,2),c.lineTo(r+3,h),c.closePath(),c.fill(),r+=5}l.current=requestAnimationFrame(e)}else l.current=requestAnimationFrame(e)}()}}}(),function(){l.current&&cancelAnimationFrame(l.current)}):(null===(o=r.current)||void 0===o||null===(o=o.getContext("2d"))||void 0===o||o.clearRect(0,0,2*n,2*t),cancelAnimationFrame(l.current),void(l.current=0))}),[a,n,t]),(0,M.jsx)("div",{className:"canvas-wrap",style:{width:"100%",height:t},children:(0,M.jsx)("canvas",{ref:r,style:{width:n,height:t}})})},L=Z.memo(R),I=t(71239),_=t(57859),F=t(95547),T=t(96247),E=(0,Z.forwardRef)((function(e,n){var t=e.autoplay,a=void 0!==t&&t,r=e.speed,l=void 0===r?1:r,s=Z.useRef(null),i=Z.useState({currentTime:0,duration:0}),c=u()(i,2),d=c[0],p=c[1],m=Z.useState(!1),f=u()(m,2),v=f[0],x=f[1],y=Z.useState(!1),g=u()(y,2),b=(g[0],g[1],Z.useState(.5)),j=u()(b,2),w=j[0],k=(j[1],Z.useState(l)),C=u()(k,2),N=C[0],S=(C[1],Z.useRef(null));(0,Z.useImperativeHandle)(n,(function(){return{play:function(){var e;null===(e=s.current)||void 0===e||e.play()},pause:function(){var e;null===(e=s.current)||void 0===e||e.pause()}}}));var z=(0,Z.useCallback)((function(){S.current=setInterval((function(){var e,n;p((function(e){var n,t;return{currentTime:Math.ceil((null===(n=s.current)||void 0===n?void 0:n.currentTime)||0),duration:e.duration||Math.ceil((null===(t=s.current)||void 0===t?void 0:t.duration)||0)}})),(null!==(e=s.current)&&void 0!==e&&e.paused||null!==(n=s.current)&&void 0!==n&&n.ended)&&(clearInterval(S.current),x(!1),p((function(e){var n;return{currentTime:null!==(n=s.current)&&void 0!==n&&n.ended?0:e.currentTime,duration:e.duration}})))}),500)}),[]),R=(0,Z.useCallback)((function(){var e,n;v?null===(e=s.current)||void 0===e||e.pause():null===(n=s.current)||void 0===n||n.play();x(!v)}),[v]),L=(0,Z.useCallback)((function(){s.current.volume=w,s.current.playbackRate=N}),[]),E=(0,Z.useCallback)((function(n){var t,r=Math.ceil((null===(t=s.current)||void 0===t?void 0:t.duration)||0);p({currentTime:0,duration:r&&r!==1/0?r:e.duration||0}),x(a)}),[a,e.duration]),A=(0,Z.useCallback)((function(e){s.current.currentTime=e,p((function(n){return{currentTime:e,duration:n.duration}}))}),[]);return(0,Z.useEffect)((function(){s.current&&L()}),[s.current]),(0,Z.useEffect)((function(){return function(){clearInterval(S.current)}}),[]),(0,M.jsxs)("div",{className:"player-wrap",style:{width:e.width||"100%"},children:[(0,M.jsxs)("div",{className:"player-ui",children:[(0,M.jsx)("span",{className:"play-btn",children:(0,M.jsx)(h.ZP,{size:"middle",type:"text",onClick:R,icon:v?(0,M.jsx)(F.Z,{style:{fontSize:"22px"}}):(0,M.jsx)(_.Z,{style:{fontSize:"22px"}})})}),(0,M.jsxs)("div",{className:"play-content",children:[(0,M.jsxs)("span",{className:"time current",children:[" ",(0,I.mr)(d.currentTime)]}),(0,M.jsxs)("div",{className:"progress-bar",children:[(0,M.jsx)("span",{className:"file-name",children:e.name}),(0,M.jsx)("div",{className:"slider",children:(0,M.jsx)(T.Z,{tooltip:{open:!1},min:0,max:d.duration,value:d.currentTime,onChange:A})}),(0,M.jsx)("span",{children:e.speed?"".concat(e.speed,"x"):"1x"})]}),(0,M.jsx)("span",{className:"time",children:(0,I.mr)(d.duration)})]}),(0,M.jsx)("span",{className:"speaker",children:(0,M.jsx)(h.ZP,{size:"middle",type:"text",icon:(0,M.jsx)(o.Z,{type:"icon-SpeakerHigh",style:{fontSize:"22px"}})})})]}),(0,M.jsx)("audio",{controls:!0,autoPlay:a,src:e.url,ref:s,preload:"metadata",style:{display:"none"},onPlay:z,onLoadedMetadata:E})]})})),A=Z.memo(E),P=t(89234),q=t(23333),D=t(30898),U=function(e){var n,t=(0,v.useIntl)(),a=Z.useCallback((function(n){var t;null===(t=e.onChange)||void 0===t||t.call(e,n)}),[]);return(0,M.jsx)(q.Z,{overlayInnerStyle:{maxWidth:265,width:"max-content"},title:t.formatMessage({id:"playground.audio.uploadfile.tips"},{formats:e.accept}),children:(0,M.jsx)(D.Z,{beforeUpload:function(e){return!0},onChange:a,accept:e.accept,multiple:!1,maxCount:1,showUploadList:!1,fileList:[],children:(0,M.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:16},children:(0,M.jsx)(h.ZP,{icon:(0,M.jsx)(P.Z,{}),type:null!==(n=e.type)&&void 0!==n?n:"text",shape:"circle"})})})})},V=Z.memo(U),H=t(571),W=function(){var e=s()(r()().mark((function e(n,t){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){try{var r=new Blob([n],{type:t}),l=(0,I.hy)(r.size),s=document.createElement("audio"),i=URL.createObjectURL(r);s.src=i,s.addEventListener("loadedmetadata",(function(){var n=s.duration;e({data:r,size:l,type:t,duration:Math.ceil(n),url:i})})),s.addEventListener("ended",(function(){URL.revokeObjectURL(s.src)}))}catch(e){a(e)}})));case 1:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),B=function(){var e=s()(r()().mark((function e(n){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){var a=new FileReader;a.onload=function(){var a=s()(r()().mark((function a(l){var s,i;return r()().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,s=l.target.result,a.next=5,W(s,n.type);case 5:i=a.sent,e(z()(z()({},i||{}),{},{name:n.name})),a.next=13;break;case 9:a.prev=9,a.t0=a.catch(0),t(a.t0);case 13:case"end":return a.stop()}}),a,null,[[0,9]])})));return function(e){return a.apply(this,arguments)}}(),a.onerror=function(e){return t(e)},a.readAsArrayBuffer(n)})));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),O=t(77353),G=t(76808),J=t(54876),Q=(t(72183),t(22471)),Y=(t(51662),t(21435),function(e){var n,t=(0,v.useIntl)(),a=(0,Z.useState)(!1),l=u()(a,2),i=(l[0],l[1]),o=(0,Z.useState)(!1),c=u()(o,2),d=c[0],p=c[1],f=(0,Z.useState)(!0),y=u()(f,2),g=y[0],b=y[1],j=(0,Z.useRef)(null),w=(0,Z.useRef)(null),k=(0,Z.useRef)(0),C=(0,Z.useRef)(null),N=(0,Z.useRef)(null),S=(0,Z.useRef)(null),z=((0,Z.useRef)(null),(0,Z.useCallback)((function(){C.current=new(window.AudioContext||window.webkitAudioContext),N.current=C.current.createAnalyser(),N.current.fftSize=256,S.current=new Uint8Array(N.current.frequencyBinCount)}),[])),R=(0,Z.useCallback)((function(){C.current.createMediaStreamSource(j.current).connect(N.current)}),[]),L=function(){var e;null===(e=j.current)||void 0===e||e.getTracks().forEach((function(e){e.stop()}))},I=function(){var e;p(!1),null===(e=w.current)||void 0===e||e.stop()},_=function(){var n=s()(r()().mark((function n(){var t;return r()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,navigator.permissions.query({name:"microphone"});case 3:"granted"===(t=n.sent).state?(b(!0),e.onAudioPermission(!0)):"denied"===t.state&&(b(!1),e.onAudioPermission(!1),I()),t.onchange=function(){_()},n.next=11;break;case 9:n.prev=9,n.t0=n.catch(0);case 11:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(){return n.apply(this,arguments)}}(),F=function(){var e=s()(r()().mark((function e(){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({audio:!0});case 3:j.current=e.sent,j.current.getAudioTracks().forEach((function(e){e.onended=function(){b(!1)}})),i(!0),b(!0),z(),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),T=function(){var n=s()(r()().mark((function n(){var t,a;return r()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!d){n.next=3;break}return r=void 0,l=void 0,null===(r=w.current)||void 0===r||r.stop(),p(!1),null===(l=e.onRecord)||void 0===l||l.call(e,!1),n.abrupt("return");case 3:return n.prev=3,n.next=6,F();case 6:w.current=new MediaRecorder(j.current),a=[],w.current.ondataavailable=function(n){var t,r;(a.push(n.data),e.voiceActivity)&&(null===(t=N.current)||void 0===t||t.getByteFrequencyData(S.current),null===(r=e.onAnalyse)||void 0===r||r.call(e,S.current,N))},w.current.onstop=function(){var n,t,r,l=new Blob(a,{type:"audio/wav"}),s=URL.createObjectURL(l);t={chunks:l,size:l.size,type:l.type,url:s,name:"recording-".concat((new Date).toISOString(),".wav"),duration:Math.ceil((Date.now()-k.current)/1e3)},null===(r=e.onAudioData)||void 0===r||r.call(e,t),null===(n=e.onAnalyse)||void 0===n||n.call(e,[],null)},p(!0),null===(t=e.onRecord)||void 0===t||t.call(e,!0),k.current=Date.now(),w.current.start(1e3),R(),n.next=21;break;case 18:n.prev=18,n.t0=n.catch(3);case 21:case"end":return n.stop()}var r,l}),n,null,[[3,18]])})));return function(){return n.apply(this,arguments)}}();return(0,Z.useEffect)((function(){return function(){I(),L()}}),[]),(0,Z.useEffect)((function(){_()}),[]),(0,M.jsx)("div",{className:"audio-input",children:(0,M.jsx)(x.Z,{size:40,className:"btns",children:(0,M.jsx)(q.Z,{title:d?t.formatMessage({id:"playground.audio.stoprecord"}):t.formatMessage({id:"playground.audio.startrecord"}),children:(0,M.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:16},children:(0,M.jsx)(h.ZP,{disabled:!g,shape:"circle",icon:(0,M.jsx)(m.Z,{}),size:"middle",type:null!==(n=e.type)&&void 0!==n?n:"text",danger:d,onClick:T})})})})})}),K=Z.memo(Y),X=t(76483),$=t(19748),ee={language:"auto"},ne=(0,Z.forwardRef)((function(e,n){var t,a=(0,v.useIntl)(),l=e.modelList,i=(0,Z.useRef)(0),c=(0,Z.useState)([{content:"",title:"",role:"",uid:i.current}]),d=u()(c,2),p=d[0],f=d[1],x=(0,v.useSearchParams)(),y=u()(x,1)[0].get("model")||"",g=(0,Z.useState)({}),b=u()(g,2),w=b[0],k=b[1],C=(0,Z.useState)(!1),S=u()(C,2),R=S[0],I=S[1],_=(0,Z.useState)(!1),F=u()(_,2),T=F[0],E=F[1],P=(0,Z.useState)(null),D=u()(P,2),U=(D[0],D[1]),W=(0,Z.useState)(!1),Y=u()(W,2),ne=Y[0],te=Y[1],ae=(0,Z.useRef)(null),re=(0,Z.useRef)(null),le=(0,Z.useRef)(null),se=(0,Z.useRef)(0),ie=(0,Z.useState)(!0),ue=u()(ie,2),oe=ue[0],ce=ue[1],de=(0,Z.useState)(null),pe=u()(de,2),me=pe[0],fe=pe[1],ve=(0,Z.useState)({data:[],analyser:null}),xe=u()(ve,2),he=xe[0],ye=xe[1],ge=(0,Z.useState)(!1),be=u()(ge,2),je=be[0],we=be[1],ke=(0,Z.useState)(!1),Ze=u()(ke,2),Ce=(Ze[0],Ze[1]),Ne=(0,Z.useRef)(null),Se=(0,H.Z)(),ze=Se.initialize,Me=Se.updateScrollerPosition,Re=(0,H.Z)().initialize;(0,Z.useImperativeHandle)(n,(function(){return{viewCode:function(){I(!0)},setCollapse:function(){te(!ne)},collapse:ne}}));var Le=function(){i.current=i.current+1},Ie=function(){var e=s()(r()().mark((function e(){var n,t,a,l,s,u,o;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=Ne.current)||void 0===n?void 0:n.form.validateFields();case 2:if(w.model){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,E(!0),Le(),U(null),null===(t=ae.current)||void 0===t||null===(a=t.abort)||void 0===a||a.call(t),ae.current=new AbortController,ae.current.signal,l=z()(z()({},w),{},{file:new File([me.data],me.name,{type:me.type})}),e.next=14,(0,N.wE)({data:l});case 14:if(null==(s=e.sent)||!s.error){e.next=18;break}return U({error:!0,errorMessage:(null==s||null===(u=s.data)||void 0===u||null===(u=u.error)||void 0===u?void 0:u.message)||(null==s||null===(o=s.data)||void 0===o?void 0:o.message)||""}),e.abrupt("return");case 18:f([{content:s.text,title:"",role:"",uid:i.current}]),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(4);case 24:return e.prev=24,E(!1),Ce(!1),we(!1),e.finish(24);case 29:case"end":return e.stop()}}),e,null,[[4,21,24,29]])})));return function(){return e.apply(this,arguments)}}(),_e=(0,Z.useCallback)((function(e){fe((function(){return{url:e.url,name:e.name,data:e.chunks,type:e.type,duration:e.duration}})),setTimeout((function(){Ce(!0)}),200)}),[]),Fe=(0,Z.useCallback)((function(e){ce(e)}),[]),Te=(0,Z.useCallback)(function(){var e=s()(r()().mark((function e(n){var t;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B(n.file.originFileObj);case 2:t=e.sent,fe(t),Ce(!0);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[]),Ee=(0,Z.useCallback)((function(e,n){ye((function(t){return{data:e,analyser:n}}))}),[]),Ae=(0,Z.useCallback)((function(e){we(e),fe(null)}),[]),Pe=function(){var e=s()(r()().mark((function e(){return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ie();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,Z.useCallback)((function(){Ce(!1),fe(null),we(!1)}),[]);return(0,Z.useEffect)((function(){}),[w]),(0,Z.useEffect)((function(){}),[p]),(0,Z.useEffect)((function(){re.current&&ze(re.current)}),[re.current,ze]),(0,Z.useEffect)((function(){le.current&&Re(le.current)}),[le.current,Re]),(0,Z.useEffect)((function(){T&&Me()}),[p,T]),(0,Z.useEffect)((function(){p.length>se.current&&Me(),se.current=p.length}),[p.length]),(0,M.jsxs)("div",{className:"ground-left-wrapper",children:[(0,M.jsxs)("div",{className:"ground-left",children:[(0,M.jsxs)("div",{className:"ground-left-footer",style:{flex:1},children:[(0,M.jsxs)("div",{className:"speech-to-text",children:[(0,M.jsxs)("div",{className:"speech-box",children:[!je&&(0,M.jsx)(V,{type:"default",accept:".mp3,.mp4,.wav",onChange:Te}),(0,M.jsx)(K,{type:"default",voiceActivity:!0,onAudioData:_e,onAudioPermission:Fe,onAnalyse:Ee,onRecord:Ae})]}),me?(0,M.jsx)("div",{className:"flex-between flex-center justify-center",children:(0,M.jsx)("div",{style:{width:600},children:(0,M.jsx)(A,{url:me.url,name:me.name,duration:me.duration})})}):oe?je?(0,M.jsx)(L,{height:66,width:200,analyserData:he}):(0,M.jsxs)("div",{className:"tips-text",children:[(0,M.jsx)(o.Z,{type:"icon-audio",style:{fontSize:20}}),(0,M.jsx)("span",{children:a.formatMessage({id:"playground.audio.speechtotext.tips"})})]}):null]}),!oe&&(0,M.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},children:[(0,M.jsx)("span",{children:(0,M.jsx)(G.Z,{style:{width:36,height:36,lineHeight:"36px",textAlign:"center"},bordered:!1,color:"error",icon:(0,M.jsx)(m.Z,{className:"font-size-16"})})}),(0,M.jsx)("span",{style:{marginTop:10,fontSize:14,fontWeight:500},children:a.formatMessage({id:"playground.audio.enablemic"})})]})]}),(0,M.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[(0,M.jsx)("div",{className:"message-list-wrap",ref:re,style:{borderTop:"1px solid var(--ant-color-split)"},children:(0,M.jsx)("div",{className:"content",style:{height:"100%"},children:(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("div",{style:{padding:"8px 14px",lineHeight:"20px",display:"flex",justifyContent:"center"},children:me?null===(t=p[0])||void 0===t?void 0:t.content:(0,M.jsx)("span",{className:"text-tertiary",children:a.formatMessage({id:"playground.audio.generating.tips"})})}),T&&(0,M.jsx)(J.Z,{size:"small",children:(0,M.jsx)("div",{style:{height:"46px"}})})]})})}),(0,M.jsx)("div",{style:{padding:"16px 32px",textAlign:"right"},children:(0,M.jsx)(q.Z,{title:a.formatMessage({id:"playground.audio.button.generate"}),children:(0,M.jsx)(h.ZP,{style:{width:46},size:"middle",disabled:!me,type:"primary",onClick:Pe,icon:(0,M.jsx)(O.Z,{})})})})]})]}),(0,M.jsx)("div",{className:j()("params-wrapper",{collapsed:ne}),ref:le,children:(0,M.jsx)("div",{className:"box",children:(0,M.jsx)(X.Z,{ref:Ne,setParams:k,paramsConfig:Q.JY,initialValues:ee,params:w,selectedModel:y,modelList:l})})}),(0,M.jsx)($.Z,{open:R,payLoad:{},api:"audio/transcriptions",clientType:"audio.transcriptions",parameters:w,onCancel:function(){I(!1)},title:a.formatMessage({id:"playground.viewcode"})})]})})),te=(0,Z.memo)(ne),ae=t(42779),re=t(2558),le=t(17098),se=t(67825),ie=t.n(se),ue=t(21970),oe=["container","url"],ce=function(e){var n=(0,Z.useRef)(null),t=e.container,a=e.url,r=ie()(e,oe);return{createWavesurfer:function(){t.current&&(n.current&&n.current.destroy(),n.current=ue.Z.create(z()({container:t.current,waveColor:"#4096ff",progressColor:"rgb(100, 0, 100)",url:a,height:60,barWidth:2,barGap:1,barRadius:2,interact:!0,cursorWidth:0},r)))},play:function(){n.current&&n.current.play()},pause:function(){n.current&&n.current.pause()},destroyWavesurfer:function(){n.current&&n.current.destroy()}}},de=["autoplay","audioUrl","speed"],pe=(0,Z.forwardRef)((function(e,n){var t=e.autoplay,a=e.audioUrl,r=e.speed,l=void 0===r?1:r,s=ie()(e,de),i=(0,Z.useRef)(null),u=ce(z()({container:i,autoplay:t,url:a,audioRate:l},s)),o=u.createWavesurfer,c=u.play,d=u.pause,p=u.destroyWavesurfer;return(0,Z.useImperativeHandle)(n,(function(){return{play:c,pause:d}})),(0,Z.useEffect)((function(){return i.current&&o(),function(){p()}}),[i.current]),(0,M.jsx)("div",{ref:i,className:"audio-container"})})),me=Z.memo(pe),fe=function(e){var n=(0,Z.useState)(!1),t=u()(n,2),a=(t[0],t[1],(0,Z.useRef)(null));return(0,M.jsxs)("div",{children:[(0,M.jsxs)("div",{className:"speech-item",children:[(0,M.jsx)("div",{className:"voice",children:(0,M.jsx)(o.Z,{type:"icon-user_voice",className:"font-size-16"})}),(0,M.jsx)("div",{className:"wrapper",children:(0,M.jsx)(me,z()(z()({},e),{},{audioUrl:e.audioUrl,ref:a}))})]}),(0,M.jsxs)("div",{className:"speech-actions",children:[(0,M.jsxs)("span",{className:"tags",children:[(0,M.jsx)("span",{className:"item",children:e.format}),(0,M.jsx)("span",{className:"item splitor"}),(0,M.jsxs)("span",{className:"item",children:[e.speed,"x"]})]}),(0,M.jsxs)("div",{className:"actions",children:[(0,M.jsx)(q.Z,{title:"Play",children:(0,M.jsx)(h.ZP,{onClick:function(){var e;null===(e=a.current)||void 0===e||e.play()},icon:(0,M.jsx)(re.Z,{}),type:"text",size:"small"})}),(0,M.jsx)(q.Z,{title:"Download",children:(0,M.jsx)(h.ZP,{onClick:function(){var n=e.audioUrl||"",t=Date.now()+"",a=document.createElement("a");a.href=n,a.download=t,document.body.appendChild(a),a.click(),a.remove()},icon:(0,M.jsx)(le.Z,{}),type:"text",size:"small"})})]})]})]})},ve=Z.memo(fe),xe=function(e){return(0,M.jsx)(M.Fragment,{children:e.dataList.map((function(e){return(0,M.jsx)(ve,z()({},e),e.uid)}))})},he=Z.memo(xe),ye=t(68476),ge=t(26598),be=t(79961),je={voice:"",response_format:"mp3",speed:1},we=(0,Z.forwardRef)((function(e,n){var t=e.modelList,a=(0,Z.useRef)(0),l=(0,Z.useState)([]),i=u()(l,2),c=i[0],d=i[1],p=(0,v.useIntl)(),m=(0,v.useSearchParams)(),f=u()(m,1)[0].get("model")||"",x=(0,Z.useState)({}),h=u()(x,2),y=h[0],g=h[1],b=(0,Z.useState)(!1),w=u()(b,2),C=w[0],S=w[1],R=(0,Z.useState)(!1),L=u()(R,2),I=L[0],_=L[1],F=(0,Z.useState)(null),T=u()(F,2),E=T[0],A=T[1],P=(0,Z.useState)(!1),q=u()(P,2),D=q[0],U=q[1],V=(0,Z.useRef)(null),W=(0,Z.useRef)(null),B=(0,Z.useRef)(null),G=(0,Z.useRef)(0),Y=(0,Z.useRef)(!0),K=(0,Z.useState)(""),ee=u()(K,2),ne=ee[0],te=ee[1],re=(0,Z.useState)([]),le=u()(re,2),se=le[0],ie=le[1],ue=(0,Z.useRef)(null),oe=(0,H.Z)(),ce=oe.initialize,de=oe.updateScrollerPosition,pe=(0,H.Z)().initialize;(0,Z.useImperativeHandle)(n,(function(){return{viewCode:function(){S(!0)},setCollapse:function(){U(!D)},collapse:D}}));var me=function(){a.current=a.current+1},fe=function(){var e=s()(r()().mark((function e(n){var t,l,s,i,u,o;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=ue.current)||void 0===t?void 0:t.form.validateFields();case 2:if(y.model){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,_(!0),me(),A(null),te((null==n?void 0:n.content)||""),null===(l=V.current)||void 0===l||null===(s=l.abort)||void 0===s||s.call(l),V.current=new AbortController,i=V.current.signal,u=z()(z()({},y),{},{input:(null==n?void 0:n.content)||ne}),e.next=15,(0,N.jQ)({data:u,url:N.qt,signal:i});case 15:o=e.sent,d([{input:(null==n?void 0:n.content)||ne,voice:y.voice,format:y.response_format,speed:y.speed,uid:a.current,autoplay:Y.current,audioUrl:o}]),e.next=22;break;case 20:e.prev=20,e.t0=e.catch(4);case 22:return e.prev=22,_(!1),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[4,20,22,25]])})));return function(n){return e.apply(this,arguments)}}(),ve=(0,Z.useCallback)(function(){var e=s()(r()().mark((function e(n){var t,a,l,s,i;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,(0,N.zv)({model:n});case 5:l=e.sent,s=k().map(l.voices||[],(function(e){return{label:e,value:e}})),ie(s),g((function(e){var n;return z()(z()({},e),{},{voice:null===(n=s[0])||void 0===n?void 0:n.value})})),null===(t=ue.current)||void 0===t||t.form.setFieldValue("voice",null===(a=s[0])||void 0===a?void 0:a.value),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(2),ie([]),null===(i=ue.current)||void 0===i||i.form.setFieldValue("voice",""),g((function(e){return z()(z()({},e),{},{voice:""})}));case 17:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(n){return e.apply(this,arguments)}}(),[t]),xe=(0,Z.useMemo)((function(){return Q.I_.map((function(e){return(0,M.jsx)(ye.Z.Item,{name:e.name,rules:e.rules,children:(0,M.jsx)(ae.Z,z()(z()({},e.attrs),{},{options:"voice"===e.name?se:e.options,label:e.label.isLocalized?p.formatMessage({id:e.label.text}):e.label.text}))},e.name)}))}),[Q.I_,p,se]);return(0,Z.useEffect)((function(){ve(y.model)}),[y.model,ve]),(0,Z.useEffect)((function(){W.current&&ce(W.current)}),[W.current,ce]),(0,Z.useEffect)((function(){B.current&&pe(B.current)}),[B.current,pe]),(0,Z.useEffect)((function(){I&&de()}),[c,I]),(0,Z.useEffect)((function(){c.length>G.current&&de(),G.current=c.length}),[c.length]),(0,M.jsxs)("div",{className:"ground-left-wrapper",children:[(0,M.jsxs)("div",{className:"ground-left",children:[(0,M.jsx)("div",{className:"message-list-wrap",ref:W,children:(0,M.jsx)("div",{style:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,M.jsxs)("div",{className:"content",style:{maxWidth:1e3},children:[c.length?(0,M.jsx)(he,{dataList:c,loading:I}):(0,M.jsxs)("div",{className:"flex-column font-size-14 flex-center gap-20",children:[(0,M.jsx)("span",{children:(0,M.jsx)(o.Z,{type:"icon-audio ",className:"font-size-32 text-secondary"})}),(0,M.jsx)("span",{children:p.formatMessage({id:"playground.audio.texttospeech.tips"})})]}),I&&(0,M.jsx)(J.Z,{size:"small",children:(0,M.jsx)("div",{style:{height:"46px"}})})]})})}),E&&(0,M.jsx)("div",{style:{height:40},children:(0,M.jsx)(be.Z,{usage:E})}),(0,M.jsx)("div",{className:"ground-left-footer",children:(0,M.jsx)(ge.Z,{actions:["check"],checkLabel:p.formatMessage({id:"playground.toolbar.autoplay"}),onCheck:function(e){Y.current=e.target.checked},loading:I,disabled:!y.model,isEmpty:!0,handleSubmit:function(e){fe(e)},handleAbortFetch:function(){var e,n;null===(e=V.current)||void 0===e||null===(n=e.abort)||void 0===n||n.call(e),_(!1)},clearAll:function(){c.length&&(me(),d([]),A(null))},shouldResetMessage:!1,submitIcon:(0,M.jsx)(O.Z,{})})})]}),(0,M.jsx)("div",{className:j()("params-wrapper",{collapsed:D}),ref:B,children:(0,M.jsx)("div",{className:"box",children:(0,M.jsx)(X.Z,{ref:ue,setParams:g,initialValues:je,params:y,selectedModel:f,modelList:t,extra:xe})})}),(0,M.jsx)($.Z,{open:C,payLoad:{input:ne},api:"audio/speech",clientType:"audio.speech",parameters:y,onCancel:function(){S(!1)},title:p.formatMessage({id:"playground.viewcode"})})]})})),ke=(0,Z.memo)(we),Ze=(t(20988),"tts"),Ce="stt",Ne=function(){var e=(0,v.useIntl)(),n=(0,p.Z)().size,t=(0,Z.useState)(Ze),a=u()(t,2),l=a[0],i=a[1],b=(0,Z.useRef)(null),w=(0,Z.useRef)(null),S=(0,Z.useState)([]),z=u()(S,2),R=z[0],L=z[1],I=(0,Z.useState)(!1),_=u()(I,2),F=_[0],T=_[1],E=[{label:e.formatMessage({id:"playground.audio.texttospeech"}),value:Ze,icon:(0,M.jsx)(m.Z,{})},{label:e.formatMessage({id:"playground.audio.speechtotext"}),value:Ce,icon:(0,M.jsx)(o.Z,{type:"icon-audio"})}],A=(0,Z.useCallback)((function(){var e,n;if(l===Ze)null===(e=b.current)||void 0===e||null===(n=e.viewCode)||void 0===n||n.call(e);else if(l===Ce){var t,a;null===(t=w.current)||void 0===t||null===(a=t.viewCode)||void 0===a||a.call(t)}}),[l]),P=(0,Z.useCallback)((function(){var e,n,t,a;l!==Ze?null===(e=w.current)||void 0===e||null===(n=e.setCollapse)||void 0===n||n.call(e):null===(t=b.current)||void 0===t||null===(a=t.setCollapse)||void 0===a||a.call(t)}),[l]),q=[{key:"tts",label:"TTS",children:(0,M.jsx)(ke,{ref:b,modelList:R})},{key:"stt",label:"Realtime",children:(0,M.jsx)(te,{modelList:R,loaded:F,ref:w})}];(0,Z.useEffect)((function(){var e,t,a;n.width<c.Z.lg&&(null!==(e=b.current)&&void 0!==e&&e.collapse||null===(t=b.current)||void 0===t||null===(a=t.setCollapse)||void 0===a||a.call(t))}),[n.width]),(0,Z.useEffect)((function(){var e=function(){var e=s()(r()().mark((function e(){var n,t,a;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={embedding_only:!1},e.next=4,(0,N.nb)(n);case 4:return t=e.sent,a=k().map(t.data||[],(function(e){return{value:e.id,label:e.id}})),e.abrupt("return",a);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),n=function(){var n=s()(r()().mark((function n(){var t;return r()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e();case 3:t=n.sent,L(t),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),T(!0);case 10:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(){return n.apply(this,arguments)}}();n()}),[]);return(0,C.y1)(d.ZP.RIGHT.join(","),(function(){var e,n;null===(e=b.current)||void 0===e||null===(n=e.setCollapse)||void 0===n||n.call(e)}),{preventDefault:!0}),(0,M.jsx)(f._z,{ghost:!0,header:{title:(0,M.jsxs)("div",{className:"flex items-center",children:[(0,M.jsx)("span",{className:"font-600",children:e.formatMessage({id:"menu.playground.speech"})}),(0,M.jsx)(y.Z,{options:E,size:"middle",className:"m-l-40",onChange:function(e){return i(e)}})]}),breadcrumb:{}},extra:"compare"!==l&&(0,M.jsxs)(x.Z,{children:[(0,M.jsx)(h.ZP,{size:"middle",onClick:A,icon:(0,M.jsx)(o.Z,{type:"icon-code",className:"font-size-16"}),children:e.formatMessage({id:"playground.viewcode"})}),(0,M.jsx)(h.ZP,{size:"middle",onClick:P,icon:(0,M.jsx)(o.Z,{type:"icon-a-layout6-line",className:"font-size-16"})})]},"buttons"),className:j()("playground-container",{compare:"compare"===l,chat:"compare"!==l}),children:(0,M.jsx)("div",{className:"play-ground",children:(0,M.jsx)("div",{className:"chat",children:(0,M.jsx)(g.Z,{items:q,activeKey:l})})})})}}}]);