(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5979],{23663:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/privacy-requests/configure/storage",function(){return s(96165)}])},43124:function(e,t,s){"use strict";s.d(t,{Z:function(){return m}});var n=s(24246),r=s(5152),i=s(88038),a=s.n(i),o=s(86677);s(27378);var l=s(11596),c=s(72247),u=s(11032),d=()=>{let e=(0,o.useRouter)();return(0,n.jsx)(r.xuv,{bg:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",p:5,mb:5,mt:5,children:(0,n.jsxs)(r.xuv,{children:[(0,n.jsxs)(r.Kqy,{direction:{base:"column",sm:"row"},justifyContent:"space-between",children:[(0,n.jsx)(r.xvT,{fontWeight:"semibold",children:"Configure your storage and messaging provider"}),(0,n.jsx)(r.wpx,{onClick:()=>{e.push(u.fz)},children:"Configure"})]}),(0,n.jsxs)(r.xvT,{children:["Before Fides can process your privacy requests we need two simple steps to configure your storage and email client."," "]})]})})},m=e=>{let{children:t,title:s,padded:i=!0,mainProps:u}=e,m=(0,l.hz)(),f=(0,o.useRouter)(),h="/privacy-requests"===f.pathname||"/datastore-connection"===f.pathname,p=!(m.flags.privacyRequestsConfiguration&&h),{data:x}=(0,c.JE)(void 0,{skip:p}),{data:g}=(0,c.PW)(void 0,{skip:p}),v=m.flags.privacyRequestsConfiguration&&(!x||!g)&&h;return(0,n.jsxs)(r.kCb,{"data-testid":s,direction:"column",h:"100vh",children:[(0,n.jsxs)(a(),{children:[(0,n.jsxs)("title",{children:["Fides Admin UI - ",s]}),(0,n.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsxs)(r.kCb,{as:"main",direction:"column",py:i?6:0,px:i?10:0,h:i?"calc(100% - 48px)":"full",flex:1,minWidth:0,overflow:"auto",...u,children:[v?(0,n.jsx)(d,{}):null,t]})]})}},60136:function(e,t,s){"use strict";s.d(t,{D4:function(){return i.D4},MM:function(){return m},Ot:function(){return c},c6:function(){return r},cj:function(){return h},e$:function(){return o},fn:function(){return l},iC:function(){return f},nU:function(){return d},tB:function(){return u}});var n,r,i=s(41164);let a="An unexpected error occurred. Please try again.",o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a;if((0,i.Bw)(e)){if((0,i.hE)(e.data))return e.data.detail;if((0,i.cz)(e.data)){var s;let t=null===(s=e.data.detail)||void 0===s?void 0:s[0];return"".concat(null==t?void 0:t.msg,": ").concat(null==t?void 0:t.loc)}if(409===e.status&&(0,i.Dy)(e.data)||404===e.status&&(0,i.XD)(e.data))return"".concat(e.data.detail.error," (").concat(e.data.detail.fides_key,")")}return t};function l(e){return"object"==typeof e&&null!=e&&"status"in e}function c(e){return"object"==typeof e&&null!=e&&"data"in e&&"string"==typeof e.data.detail}function u(e){return"object"==typeof e&&null!=e&&"data"in e&&Array.isArray(e.data.detail)}let d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{status:500,message:a};if((0,i.oK)(e))return{status:e.originalStatus,message:e.data};if((0,i.Bw)(e)){let{status:s}=e;return{status:s,message:o(e,t.message)}}return t},m=e=>Object.entries(e).map(e=>({value:e[1],label:e[1]}));(n=r||(r={})).GVL="gvl",n.AC="gacp",n.COMPASS="compass";let f={gvl:{label:"GVL",fullName:"Global Vendor List"},gacp:{label:"AC",fullName:"Google Additional Consent List"},compass:{label:"",fullName:""}},h=e=>{let t=e.split(".")[0];return"gacp"===t?"gacp":"gvl"===t?"gvl":"compass"}},53359:function(e,t,s){"use strict";s.d(t,{H:function(){return i},V:function(){return n.V}});var n=s(75139),r=s(60136);let i=()=>{let{errorAlert:e}=(0,n.V)();return{handleError:t=>{let s="An unexpected error occurred. Please try again.";(0,r.Ot)(t)?s=t.data.detail:(0,r.tB)(t)&&(s=t.data.detail[0].msg),e(s)}}}},75139:function(e,t,s){"use strict";s.d(t,{V:function(){return i}});var n=s(24246),r=s(5152);let i=()=>{let e=(0,r.pmc)();return{errorAlert:(t,s,i)=>{let a={...i,position:(null==i?void 0:i.position)||"top",render:e=>{let{onClose:i}=e;return(0,n.jsxs)(r.bZj,{alignItems:"normal",status:"error",children:[(0,n.jsx)(r.zMQ,{}),(0,n.jsxs)(r.xuv,{children:[s&&(0,n.jsx)(r.CdC,{children:s}),(0,n.jsx)(r.XaZ,{children:t})]}),(0,n.jsx)(r.PZ7,{onClick:i,position:"relative",right:0,size:"sm",top:-1})]})}};(null==i?void 0:i.id)&&e.isActive(i.id)?e.update(i.id,a):e(a)},successAlert:(t,s,i)=>{let a={...i,position:(null==i?void 0:i.position)||"top",render:e=>{let{onClose:i}=e;return(0,n.jsxs)(r.bZj,{alignItems:"normal",status:"success",variant:"subtle",children:[(0,n.jsx)(r.zMQ,{}),(0,n.jsxs)(r.xuv,{children:[s&&(0,n.jsx)(r.CdC,{children:s}),(0,n.jsx)(r.XaZ,{children:t})]}),(0,n.jsx)(r.PZ7,{onClick:i,position:"relative",right:0,size:"sm",top:-1})]})}};(null==i?void 0:i.id)&&e.isActive(i.id)?e.update(i.id,a):e(a)}}}},73485:function(e,t,s){"use strict";s.d(t,{R:function(){return o}});var n=s(24246),r=s(5152),i=s(79894),a=s.n(i);let o=e=>{let{onClick:t,...s}=e;return(0,n.jsxs)(r.kCb,{alignItems:"center",mt:-4,mb:3,onClick:t,cursor:"pointer",...s,children:[(0,n.jsx)(r.wpx,{"aria-label":"Back",icon:(0,n.jsx)(r.Rpv,{}),className:"mr-2",size:"small"}),(0,n.jsx)(r.xvT,{as:"a",fontSize:"sm",fontWeight:"500",children:"Back"})]})};t.Z=e=>{let{backPath:t,...s}=e;return(0,n.jsxs)(r.kCb,{alignItems:"center",mb:6,...s,children:[(0,n.jsx)(r.wpx,{href:t,"aria-label":"Back",icon:(0,n.jsx)(r.Rpv,{}),className:"mr-2",size:"small"}),(0,n.jsx)(r.xvT,{as:a(),href:t,fontSize:"sm",fontWeight:"500",children:"Back"})]})}},95758:function(e,t,s){"use strict";s.d(t,{DE:function(){return o},MP:function(){return r},qX:function(){return a},rE:function(){return i}});var n=s(10284);let r=new Map([[n.q2.APPROVED,"Approved"],[n.q2.CANCELED,"Canceled"],[n.q2.COMPLETE,"Completed"],[n.q2.DENIED,"Denied"],[n.q2.ERROR,"Error"],[n.q2.IN_PROCESSING,"In Progress"],[n.q2.PENDING,"New"],[n.q2.PAUSED,"Paused"],[n.q2.IDENTITY_UNVERIFIED,"Unverified"],[n.q2.REQUIRES_INPUT,"Requires input"]]),i=new Map([[n.Us.ACCESS,"Access"],[n.Us.ERASURE,"Erasure"],[n.Us.CONSENT,"Consent"],[n.Us.UPDATE,"Update"]]),a={mailgun:"mailgun",twilio_email:"twilio_email",twilio_text:"twilio_text"},o={local:"local",s3:"s3"}},96165:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var n=s(24246),r=s(5152),i=s(27378),a=s(60136),o=s(53359),l=s(43124),c=s(73485),u=s(11032),d=s(95758),m=s(72247),f=s(34090),h=s(9043),p=e=>{var t,s,l,c,u;let{storageDetails:p}=e,[x,g]=(0,i.useState)(""),[v]=(0,m.gC)(),[y]=(0,m.cf)(),{handleError:j}=(0,o.H)(),{successAlert:b}=(0,o.V)(),_={type:d.DE.s3,auth_method:null!==(l=null==p?void 0:null===(t=p.details)||void 0===t?void 0:t.auth_method)&&void 0!==l?l:"",bucket:null!==(c=null==p?void 0:null===(s=p.details)||void 0===s?void 0:s.bucket)&&void 0!==c?c:"",format:null!==(u=null==p?void 0:p.format)&&void 0!==u?u:""},w=async e=>{let t=await v({type:d.DE.s3,details:{auth_method:e.auth_method,bucket:e.bucket},format:e.format});(0,a.D4)(t)?j(t.error):(g(e.auth_method),b("S3 storage credentials successfully updated."))},C=async e=>{let t=await y({details:{aws_access_key_id:e.aws_access_key_id,aws_secret_access_key:e.aws_secret_access_key},type:d.DE.s3});(0,a.D4)(t)?j(t.error):b("S3 storage secrets successfully updated.")};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.X6q,{fontSize:"md",fontWeight:"semibold",mt:10,children:"S3 storage configuration"}),(0,n.jsx)(r.Kqy,{children:(0,n.jsx)(f.J9,{initialValues:_,onSubmit:w,enableReinitialize:!0,children:e=>{let{isSubmitting:t,handleReset:s}=e;return(0,n.jsxs)(f.l0,{children:[(0,n.jsxs)(r.Kqy,{mt:5,spacing:5,children:[(0,n.jsx)(h.AP,{name:"format",label:"Format",options:[{label:"json",value:"json"},{label:"csv",value:"csv"}],"data-testid":"format",isRequired:!0}),(0,n.jsx)(h.AP,{name:"auth_method",label:"Auth method",options:[{label:"secret_keys",value:"secret_keys"},{label:"automatic",value:"automatic"}],"data-testid":"auth_method",isRequired:!0}),(0,n.jsx)(h.j0,{"data-testid":"bucket",name:"bucket",label:"Bucket",isRequired:!0})]}),(0,n.jsx)(r.wpx,{onClick:()=>s(),className:"mr-2 mt-5",children:"Cancel"}),(0,n.jsx)(r.wpx,{htmlType:"submit",className:"mt-5",disabled:t,type:"primary","data-testid":"save-btn",children:"Save"})]})}})}),"secret_keys"===x?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.izJ,{mt:5}),(0,n.jsx)(r.X6q,{fontSize:"md",fontWeight:"semibold",mt:5,children:"Storage destination"}),(0,n.jsx)(r.Kqy,{children:(0,n.jsx)(f.J9,{initialValues:{aws_access_key_id:"",aws_secret_access_key:""},onSubmit:C,children:e=>{let{isSubmitting:t,handleReset:s}=e;return(0,n.jsxs)(f.l0,{children:[(0,n.jsxs)(r.Kqy,{mt:5,spacing:5,children:[(0,n.jsx)(h.j0,{name:"aws_access_key_id",label:"AWS access key ID"}),(0,n.jsx)(h.j0,{name:"aws_secret_access_key",label:"AWS secret access key",type:"password"})]}),(0,n.jsxs)(r.xuv,{mt:10,children:[(0,n.jsx)(r.wpx,{onClick:()=>s(),className:"mr-2 mt-5",children:"Cancel"}),(0,n.jsx)(r.wpx,{disabled:t,htmlType:"submit",type:"primary",className:"mt-5","data-testid":"save-btn",children:"Save"})]})]})}})})]}):null]})},x=()=>{let{successAlert:e}=(0,o.V)(),{handleError:t}=(0,o.H)(),[s,f]=(0,i.useState)(""),{data:h}=(0,m.PW)(),{data:x}=(0,m.Au)({type:s}),[g,{isLoading:v}]=(0,m.gC)(),[y]=(0,m.L)();(0,i.useEffect)(()=>{h&&f(h.type)},[h]);let j=async s=>{if(s===d.DE.local){let n=await g({type:s,details:{},format:"json"});(0,a.D4)(n)?t(n.error):e("Configured storage details successfully.")}let n=await y({storage:{active_default_storage_type:s}});(0,a.D4)(n)?t(n.error):f(s)};return(0,n.jsxs)(l.Z,{title:"Configure Privacy Requests - Storage",children:[(0,n.jsx)(c.Z,{backPath:u.fz}),(0,n.jsx)(r.X6q,{mb:5,fontSize:"2xl",fontWeight:"semibold",children:"Configure storage"}),(0,n.jsxs)(r.xuv,{display:"flex",flexDirection:"column",width:"50%",children:[(0,n.jsx)(r.xuv,{mb:5,children:"Fides requires a storage destination to store and share the results of privacy requests. For a production setup, it is highly recommended to have S3 as a storage destination. Ensure you have completed the setup for the storage destination and have the details handy prior to the following steps."}),(0,n.jsxs)(r.xuv,{children:["To configure a Storage destination, first choose a method to store your results. Fides currently supports"," ",(0,n.jsx)(r.xvT,{as:"span",color:"complimentary.500",children:"Local"})," ","and"," ",(0,n.jsx)(r.xvT,{as:"span",color:"complimentary.500",children:"S3"})," ","storage methods."]}),(0,n.jsx)(r.X6q,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Choose storage type to configure"}),(0,n.jsx)(r.FXm,{isDisabled:v,onChange:j,value:s,"data-testid":"privacy-requests-storage-selection",colorScheme:"secondary",p:3,children:(0,n.jsxs)(r.Kqy,{direction:"row",children:[(0,n.jsx)(r.Y8K,{value:"local","data-testid":"option-local",mr:5,children:"Local"},"local"),(0,n.jsx)(r.Y8K,{value:"s3","data-testid":"option-s3",children:"S3"},"s3")]})}),"s3"===s&&x?(0,n.jsx)(p,{storageDetails:x}):null]})]})},g=()=>(0,n.jsx)(x,{})},41164:function(e,t,s){"use strict";s.d(t,{Bw:function(){return a},D4:function(){return r},Dy:function(){return l},XD:function(){return c},cz:function(){return u},hE:function(){return o},oK:function(){return i}});var n=s(76649);let r=e=>"error"in e,i=e=>(0,n.Ln)({status:"string"},e)&&"PARSING_ERROR"===e.status,a=e=>(0,n.Ln)({status:"number",data:{}},e),o=e=>(0,n.Ln)({detail:"string"},e),l=e=>(0,n.Ln)({detail:{error:"string",resource_type:"string",fides_key:"string"}},e),c=e=>(0,n.Ln)({detail:{error:"string",resource_type:"string",fides_key:"string"}},e),u=e=>(0,n.Ln)({detail:[{loc:["string","number"],msg:"string",type:"string"}]},e)},76649:function(e,t,s){"use strict";s.d(t,{Ln:function(){return n}});let n=(e,t)=>i(e,t),r=Symbol("SOME"),i=(e,t)=>"string"==typeof e?e===typeof t:Array.isArray(e)?r in e?e.some(e=>i(e,t)):!!Array.isArray(t)&&(0===e.length||t.every(t=>e.some(e=>i(e,t)))):"object"==typeof t&&null!==t&&Object.entries(e).every(([e,s])=>i(s,t[e]));class a{static narrow(e){return new a(t=>n(e,t))}constructor(e){this.NF=void 0,this.NF=e}satisfied(e){return this.NF(e)}build(e){return e}and(e){let t=this.NF,s=e instanceof a?e.NF:e instanceof Function?e:t=>n(e,t);return new a(e=>t(e)&&s(e))}}new a(e=>!0)}},function(e){e.O(0,[2888,9774,179],function(){return e(e.s=23663)}),_N_E=e.O()}]);