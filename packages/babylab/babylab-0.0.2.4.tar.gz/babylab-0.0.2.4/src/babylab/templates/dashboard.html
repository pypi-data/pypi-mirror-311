{% extends 'base.html' %}

{% block content %}
<div class="card" style="width: 12rem; height: 15em; float: left; margin-right: 1em; margin-bottom: 2em;">
  <div class="card-header">Summary</div>
  <div class="card-body">
    <p class="card-text">Participants: {{ n_ppts }}</p>
    <p class="card-text">Appointments: {{ n_apts }}</p>
  </div>
</div>

<div class="card" style="width: 20rem; height: 15em; float:left; margin-right: 1em; margin-bottom: 2em;">
  <div class="card-header">Age distribution</div>
  <canvas id="ageDist" width="16em" height="9em">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      const ctx = document.getElementById("ageDist").getContext("2d")
      new Chart(ctx, {
        type: "scatter",
        data: {
          title: "",
          labels: {{ age_dist_labels | safe }},
        datasets: [{
          data: {{ age_dist_values | safe}},
        backgroundColor: '#ea6212',
        borderColor: '#ea6212',
            }]
          },
        options: {
        plugins: {
          legend: {
            display: false
          }
        },
        scales: {
          x: {
            title: {
              display: true,
              text: "Age (days)",
            },
            ticks: {
              beginAtZero: false,
              stepSize: 10,
              suggestedMin: 'min-int-value',
              suggestedMax: 'max-int-value'
            }
          },
          y: {
            title: {
              display: true,
              text: "# of participants",
            },
            ticks: {
              beginAtZero: true,
              stepSize: 1,
              suggestedMin: 'min-int-value',
              suggestedMax: 'max-int-value'
            }
          }
        }
      }
        })
    </script>
  </canvas>
</div>
<div class="card" style="width: 15rem; height: 15em; float:left; margin-right: 1em; margin-bottom: 2em;">
  <div class="card-header">Sex distribution</div>
  <canvas id="sexDist" width="8em" height="6.5em">
    <script>
      const stx = document.getElementById("sexDist").getContext("2d")
      new Chart(stx, {
        type: "bar",
        data: {
          labels: {{ sex_dist_labels | safe }},
        datasets: [{
          label: "Sex",
          data: {{ sex_dist_values | safe}},
        backgroundColor: '#ff001e',
        borderColor: '#ff001e',
            }]
          },
        options: {
        plugins: {
          legend: {
            display: false
          }
        },
        scales: {
          x: {
            title: {
              display: true,
              text: "Sex",
            },
            ticks: {
              beginAtZero: false,
              stepSize: 10,
              suggestedMin: 'min-int-value',
              suggestedMax: 'max-int-value'
            }
          },
          y: {
            title: {
              display: true,
              text: "# participants",
            },
            ticks: {
              beginAtZero: true,
              stepSize: 1,
              suggestedMin: 'min-int-value',
              suggestedMax: 'max-int-value'
            }
          }
        }
      }
        })
    </script>
  </canvas>
</div>
<div class="card" style="width: 30rem; height: 15em; float:left; margin-right: 1em;">
  <div class="card-header">Participant influx</div>
  <canvas id="influx" width="900" height="400">
    <script src="https://cdn.jsdelivr.net/npm/chart.js/dist/chart.min.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script>
      const ttx = document.getElementById("influx").getContext("2d")
      new Chart(ttx, {
        type: "line",
        data: {
          labels: {{ date_added_labels | safe }},
        datasets: [
        {
          label: "# participants",
          data: {{ date_added_values | safe}},
        backgroundColor: '#781478',
        borderColor: '#781478',
        tension: 0.25,
        pointRadius: 5,
          },
        {
          label: "# appointments",
          data: {{ date_made_values | safe }},
        backgroundColor: '#ea6212',
        borderColor: '#ea6212',
        tension: 0.25,
        pointRadius: 5,
          }
      ]
          },
        options: {
        plugins: {
          legend: {
            display: true
          }
        },
        scales: {
          y: {
            title: {
              display: true,
              text: '# participants'
            },
            ticks: {
              beginAtZero: true,
              stepSize: 1,
              suggestedMin: 'min-int-value',
              suggestedMax: 'max-int-value'
            }
          },
          x: {
            type: 'time',
            time: {
              unit: "week"
            },
            title: {
              display: true,
              text: 'Date'
            }
          },
        }
      }
        })
    </script>
  </canvas>
</div>
<div class="card" style="width: 30rem; height: 15em; float:left; margin-right: 1em;">
  <div class="card-header">Appointments made</div>
  <canvas id="appointments" width="900" height="400">
    <script src="https://cdn.jsdelivr.net/npm/chart.js/dist/chart.min.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script>
      const rtx = document.getElementById("appointments").getContext("2d")
      new Chart(rtx, {
        type: "line",
        data: {
          labels: {{ date_made_labels | safe }},
        datasets: [{
          label: "# appointments",
          data: {{ date_made_values | safe}},
        backgroundColor: '#ea6212',
        borderColor: '#ea6212',
        tension: 0.25,
        pointRadius: 5,
            }]
          },
        options: {
        plugins: {
          legend: {
            display: false
          }
        },
        scales: {
          y: {
            title: {
              display: true,
              text: '# appointments'
            },
            ticks: {
              beginAtZero: true,
              stepSize: 1,
              suggestedMin: 'min-int-value',
              suggestedMax: 'max-int-value'
            }
          },
          x: {
            type: 'time',
            time: {
              unit: "week"
            },
            title: {
              display: true,
              text: 'Date'
            }
          },
        }
      }
    })
    </script>
  </canvas>
</div>
{% endblock %}